项目名称,项目URL,提交ID,提交者,提交时间,提交信息,提交链接
iovisor/bcc,https://github.com/iovisor/bcc,7da5916,Jerome Marchand,2025-11-27T13:53:16Z,libbpf-tools/cpufreq: Print a more informative message when CPU Frequency Scaling isn't available  The cpufreq tool relies on CPU Frequency Scaling. Display a more informative message to the user when the feature isn't available than just complaining about a missing sysfs file.  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>,https://github.com/iovisor/bcc/commit/7da5916622dc3a581e4c4adc3003e588657f66fa
iovisor/bcc,https://github.com/iovisor/bcc,380ee01,Jian Zhao,2025-11-12T07:21:27Z,"tools/offwaketime: Add raw tracepoint support to reduce overhead  This patch adds support for raw tracepoints in offwaketime tool to reduce overhead compared to kprobes. Raw tracepoints have lower overhead because they don't require function entry/exit instrumentation.  The implementation: - Adds RAW_TRACEPOINT_PROBE handlers for sched_switch and sched_wakeup - Creates kprobe wrapper functions for backward compatibility - Automatically selects raw tracepoints when supported, falls back to   kprobes otherwise - Refactors oncpu() function to accept both prev and next task_struct   parameters for raw tracepoint compatibility  This follows the same pattern used in other BCC tools like wakeuptime.py and runqlat.py.  Signed-off-by: Jack Zhao <jackjzhao@tencent.com>",https://github.com/iovisor/bcc/commit/380ee018bbd04e0300c811bebd88c84da59f715f
iovisor/bcc,https://github.com/iovisor/bcc,9691c56,xixiliguo,2025-11-08T16:12:24Z,Add support for fuse to fsdist and fsslower tools,https://github.com/iovisor/bcc/commit/9691c56891fb833351d3cfe69bda4a57076c3b62
iovisor/bcc,https://github.com/iovisor/bcc,fb8910a,Jerome Marchand,2025-10-09T10:23:53Z,"tools/javaobjnew: Use MIN macro instead of min function  The function min() is called among the arguments of bpf_probe_read_user(). Depending on kernel version, the expansion of the macro may emmit a fake function that prevent the compilation of the BPF code.  Replace the min() function by the MIN() macro to solve the issue. This is safe since both members of the comparison are unsigned integer.  Solves the following error: /virtual/main.c:48:36: error: cannot call non-static helper function    48 |     bpf_probe_read_user(&key.name, min(sizeof(key.name), (size_t)length), (void *)classptr);       |                                    ^ include/linux/minmax.h:129:19: note: expanded from macro 'min'   129 | #define min(x, y)       __careful_cmp(min, x, y)       |                         ^ include/linux/minmax.h:105:2: note: expanded from macro '__careful_cmp'   105 |         __careful_cmp_once(op, x, y, __UNIQUE_ID(x_), __UNIQUE_ID(y_))       |         ^ include/linux/minmax.h:100:2: note: expanded from macro '__careful_cmp_once'   100 |         BUILD_BUG_ON_MSG(!__types_ok(x,y,ux,uy),        \       |         ^ note: (skipping 2 expansions in backtrace; use -fmacro-backtrace-limit=0 to see all) include/linux/compiler_types.h:418:2: note: expanded from macro '_compiletime_assert'   418 |         __compiletime_assert(condition, msg, prefix, suffix)       |         ^ include/linux/compiler_types.h:411:4: note: expanded from macro '__compiletime_assert'   411 |                         prefix ## suffix();                             \       |                         ^ <scratch space>:91:1: note: expanded from here    91 | __compiletime_assert_317       | ^ 1 error generated. Traceback (most recent call last):   File ""/usr/share/bcc/tools/lib/uobjnew"", line 178, in <module>     bpf = BPF(text=program, usdt_contexts=[usdt])   File ""/usr/lib/python3.9/site-packages/bcc/__init__.py"", line 507, in __init__     raise Exception(""Failed to compile BPF module %s"" % (src_file or ""<text>"")) Exception: Failed to compile BPF module <text>  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/fb8910a8bc6e0bf6de8351318309e8638818a9db
iovisor/bcc,https://github.com/iovisor/bcc,c351210,Hoyeon Lee,2025-10-23T05:08:54Z,"tests: add coverage for versioned SONAME resolution  Add tests for bcc_procutils_which_so{_in_process}() to verify correct behavior when resolving versioned SONAME fragments.  Use library with long-stable SONAME version (libc.so.6), which have remained unchanged for over a decade and ensure deterministic results across systems.  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/c3512104c23baff0385f9d45999ac4c09378a635
iovisor/bcc,https://github.com/iovisor/bcc,beb1fe4,Hoyeon Lee,2025-10-23T05:01:23Z,"cc: support versioned SONAME in shared library resolution  bcc_procutils_which_so() and related helpers previously handled only short library names (e.g. ""ssl""), constructing ""lib%s.so"" and selecting the first cache entry from /etc/ld.so.cache.  This change makes to recognize versioned SONAME fragments that contain "".so.x"" (e.g. ""ssl.so.3.5.3"", ""crypto.so.3""), treating such names as exact matches instead of appending another "".so"". This enables correct resolution of versioned libraries (e.g. libssl.so.3 vs libssl.so.59) while maintaining compatibility with existing short-name lookups.  This improves correctness on systems where multiple SONAME variants coexist in the cache (e.g. OpenSSL vs LibreSSL).  Related: #5412  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/beb1fe40e1183a9068c93640e4687342d822c4e3
iovisor/bcc,https://github.com/iovisor/bcc,c208d0e,Jerome Marchand,2025-10-07T14:58:04Z,tools/tcpaccept: Fix tcpaccept on recent kernel  The tcpaccept use the relative offset of gso_max_segs and sk_lingertime_offset to check whether sk_protocol is its own field of part of a bitfield and find it's location. This is not very robust.  Use BPF.kernel_struct_has_field() to find out whether it's its own field and revert to the old workaround if it's part of a bitfield or BTF is unavailable.  Closes: #5316  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>,https://github.com/iovisor/bcc/commit/c208d0e67ff8ee7ae88885d0eedb82abe6824934
iovisor/bcc,https://github.com/iovisor/bcc,1cc15c3,Jerome Marchand,2025-10-07T12:05:56Z,tools: Don't use the old bpf_probe_read() helper.  The old bpf_probe_read() helper doesn't work on s390 arch. Use bpf_probe_read_user/kernel() instead.  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>,https://github.com/iovisor/bcc/commit/1cc15c3db556d2f61d0bc7cd8aedeb245ef532a1
iovisor/bcc,https://github.com/iovisor/bcc,b63d7e3,Stefan Walter,2025-10-11T08:35:41Z,re-generate syscall list (add file_getattr / file_setattr),https://github.com/iovisor/bcc/commit/b63d7e38e8a0f6339fbd57f3a1ae7297e1993d92
iovisor/bcc,https://github.com/iovisor/bcc,b3f4d6d,Jerome Marchand,2025-10-07T13:32:36Z,"libbpf-tools/javagc: Include usdt.bpf.h header  Include usdt.bpf.h header to javagc.bpf.c.  Fixes the following error: libbpf: usdt: failed to find USDT support BPF maps, did you forget to include bpf/usdt.bpf.h? attach usdt mem__pool__gc__begin failed: No such process  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/b3f4d6d2fc421952e8115fcf70f2551e6791f7ef
iovisor/bcc,https://github.com/iovisor/bcc,212540c,Aiden Grossman,2025-10-14T23:54:09Z,Avoid using deprecated string triple TargetRegistry overloads (#5401)  These functions calls are deprecated and will most likely be removed in LLVM version 23.,https://github.com/iovisor/bcc/commit/212540ca898fc220f848acadafa6f1b415d909ae
iovisor/bcc,https://github.com/iovisor/bcc,e58d680,Hoyeon Lee,2025-09-17T15:23:44Z,"tools: return error code on invalid options  Many tools were exiting with code 0 when given invalid or conflicting options (e.g. mutually exclusive arguments, zero intervals). This patch updates those cases to exit(1), ensuring argument errors propagate as failures to the caller.  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/e58d68063637393e01a7788215f0ddc6e479e6b4
iovisor/bcc,https://github.com/iovisor/bcc,a07d117,Hoyeon Lee,2025-09-17T14:58:43Z,"tools: return error code when required kallsyms symbols are missing  When symbols such as *_file_operations or vm_zone_stat are not found in /proc/kallsyms, the scripts exited with code 0. Change these cases to exit(1) so that missing symbol errors are reported correctly, rather than appearing as successful termination.  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/a07d1177d69c6deb2f7433a0cb79d208cf165def
iovisor/bcc,https://github.com/iovisor/bcc,bc6a98a,Hoyeon Lee,2025-09-17T15:03:36Z,"tools: return error code when no trace events matched  Several tools were using plain exit() when no kprobes or tracepoints could be attached. This returned 0 to the shell, incorrectly signaling success. Update these cases to use exit(1) so the failure is properly reported to the caller.  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/bc6a98a02d65504289e835c71419492cd1f60cc8
iovisor/bcc,https://github.com/iovisor/bcc,2b73f76,Ism Hong,2025-09-08T09:43:16Z,"libbpf-tools: Fix list_syscalls() prototype return type  The function list_syscalls() in syscall_helpers.c returns an integer value, but its prototype in syscall_helpers.h declared a void return type.  This commit corrects the function prototype in syscall_helpers.h to match its implementation, changing the return type from void to int.  Fixes: f3fbeb46cb52 (""libbpf-tools: convert BCC syscount to BPF CO-RE version"") Signed-off-by: Ism Hong <ism.hong@gmail.com>",https://github.com/iovisor/bcc/commit/2b73f76eab440111a717f53290636f8233f15306
iovisor/bcc,https://github.com/iovisor/bcc,791bf81,Hoyeon Lee,2025-09-01T15:57:07Z,"tools/filetop: fix DNAME_INLINE_LEN by folding to integer constant (#5390)  Since Linux v6.14 (commit 61bc24ac974a), DNAME_INLINE_LEN is defined as an expression instead of a constant integer:  	#define DNAME_INLINE_LEN (DNAME_INLINE_WORDS * sizeof(unsigned long))  This causes the name array in struct info_t to be shown in map metadata as [""name"", ""char""""unsigned long"", [40]] instead of the correct [""name"", ""char"", [40]], breaking dumping of the counts map.  Rather than modifying AST handling, fix by storing DNAME_INLINE_LEN in an enum constant after including kernel headers. Enum values are compile-time integer constants, so the expression is folded to a literal and no longer carries the sizeof() expression into the AST.  Closes: iovisor/bcc#5337  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/791bf81ad9ec18ce2899f79509e4de96ddc21e9d
iovisor/bcc,https://github.com/iovisor/bcc,a665f31,Hoyeon Lee,2025-09-01T15:40:55Z,"doc: Fix the build guide for openSUSE (#5393)  On openSUSE, LLVM/Clang static libraries are not provided by default. This causes CMake to fail with ""unknown component LLVMBitWriter"" when building bcc. To fix this, add `-DENABLE_LLVM_SHARED=1` in the build instructions for openSUSE.  Signed-off-by: Hoyeon Lee <hoyeon.lee@suse.com>",https://github.com/iovisor/bcc/commit/a665f31399e7184ab2967f9000f800c75460478c
iovisor/bcc,https://github.com/iovisor/bcc,52d2d09,Ism Hong,2025-08-26T07:03:55Z,"libbpf-tools/biotop: Fix segmentation fault with musl libc build  When building with musl libc, biotop would crash with a segmentation fault due to an uninitialized local variable line in the parse_disk_stat() function.  This commit initializes the line variable to NULL to prevent the crash.  Fixes: ca5fd8ee6fe0 (""libbpf-tools: Add biotop tool) Signed-off-by: Ism Hong <ism.hong@gmail.com>",https://github.com/iovisor/bcc/commit/52d2d098a7d69b6477df1a71ebd56bd4bfc6d81a
iovisor/bcc,https://github.com/iovisor/bcc,f55a2f6,Bojun Seo,2025-08-06T04:15:29Z,"Removing trailing white spaces and fixing typo (#5383)  * Remove trailing white spaces Trailing whitespaces are removed from all files, empty lines and image files are preserved. This patch is created using the following shell commands:    find . -type f -not -path '*/\.*' -exec sed -i '/^$/!s/[ \t]*$//' {} \;  * docs/reference_guide.md: Fix typo",https://github.com/iovisor/bcc/commit/f55a2f67e05d7cea44f3d850000fd6123caeeda0
iovisor/bcc,https://github.com/iovisor/bcc,0b53e33,Francois Lesueur,2025-08-06T04:11:02Z,tools/tcpconnect: fix iov field for DNS with Linux>=6.4 (#5382)  Tcpconnect with DNS (-d flag) does not work with Linux>=6.4. The kernel representation of struct iov_iter changed in 6.4.  This PR adapts the iov field depending on the structure. It also removes inet_sk() which did not work on a recent kernel (6.6).,https://github.com/iovisor/bcc/commit/0b53e3396c7eed6c20394a683c06b8eeaaa6be4e
iovisor/bcc,https://github.com/iovisor/bcc,bfa05d2,Rong Tao,2025-07-29T08:25:55Z,"python: tcp.py: add state2str() and apply to tools  There are two tools/{tcpretrans.py,tcpstates.py,tcpdrop.py} display the TCP state, and those code already exist in bcc/tcp.py, thus, this patch remove the duplicate code and add bcc.tcp.state2str() function.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/bfa05d28cfead816f59e616dfaaf31b9644a8a08
iovisor/bcc,https://github.com/iovisor/bcc,7676954,Matt Pelland,2025-07-28T18:41:21Z,tools/kvmexit: silence compiler warnings  Depending on the environment that the kvmexit tool is used in various BPF compiler warnings may be emitted when running the tool. Silence these warnings unless the --debug argument is passed in order to make it easier to consume the tool's output.  Signed-off-by: Matt Pelland <mpelland@akamai.com>,https://github.com/iovisor/bcc/commit/7676954937b1b89c5e99c6bc2e64aa9dcf066feb
iovisor/bcc,https://github.com/iovisor/bcc,b7f6d0e,Matt Pelland,2025-07-28T18:32:04Z,tools/kvmexit: reformat header to match other tools  Most of the other tools implement a small changelog as the last part of the header comment. Reformat the header for kvmexit to match and add items covering AMD support and postprocessing parallelization.  Signed-off-by: Matt Pelland <mpelland@akamai.com>,https://github.com/iovisor/bcc/commit/b7f6d0ea7e89ea8c9eec02e1ec2ee9610265e1c1
iovisor/bcc,https://github.com/iovisor/bcc,c2af2ee,Matt Pelland,2025-07-28T18:16:29Z,"tools/kvmexit: implement parallel post processing  Post processing VM exit counts on high core count machines can take a very long time. Speed the process up by taking advantage of multiple cores where possible while also limiting the amount of parallelism to conserve resources.  Prior to this patch, running kvmexit.py against a 32 core VM on a 640 core machine took:  real    36m54.137s user    2m58.306s sys     33m45.453s  Afterwards:  real	5m14.744s user	36m57.590s sys	220m40.339s  Signed-off-by: Matt Pelland <mpelland@akamai.com>",https://github.com/iovisor/bcc/commit/c2af2eea25ba906ad3c9db0ef8d31fc64b86d191
iovisor/bcc,https://github.com/iovisor/bcc,13a4e5a,Matt Pelland,2025-07-28T17:52:40Z,tools/kvmexit: support amd processors  AMD's virtualization extensions (SVM) implement their own set of VM exit reasons. Import these from arch/x86/include/uapi/asm/svm.h in the upstream Linux kernel and change the supported vendor logic to work with either AMD or Intel.  Signed-off-by: Matt Pelland <mpelland@akamai.com>,https://github.com/iovisor/bcc/commit/13a4e5a462352a1ca8a8e9ff3b421bafce44bc7b
iovisor/bcc,https://github.com/iovisor/bcc,b81b93e,Bojun Seo,2025-07-28T06:42:30Z,tools/solisten_example.txt: fix typo,https://github.com/iovisor/bcc/commit/b81b93e4a44936586c5de8023b0f9053646ab397
iovisor/bcc,https://github.com/iovisor/bcc,da3a474,Ze Huang,2025-07-20T14:16:51Z,tools/tcptop: use fentry/fexit to trace TCP receive  Replace kprobe on tcp_cleanup_rbuf with fentry/fexit on tcp_recvmsg. Adds a dedicated sock_recv map to track receive-side sockets.  Signed-of-by: Ze Huang <huang.ze@linux.dev>,https://github.com/iovisor/bcc/commit/da3a474656ae6bc5d5e7a4b88caf00cfe4d75d6e
iovisor/bcc,https://github.com/iovisor/bcc,d786eaa,Ze Huang,2025-07-20T13:57:33Z,tools/tcptop: unify send/recv stats in tcp_stat()  Rename tcp_sendstat() to tcp_stat() and extend it to support receive-side statistics based on is_send flag.  Signed-off-by: Ze Huang <huang.ze@linux.dev>,https://github.com/iovisor/bcc/commit/d786eaa3388c2a543cb2d19b4e6f445f65b37b9f
iovisor/bcc,https://github.com/iovisor/bcc,e2c7917,Ze Huang,2025-07-20T13:47:07Z,tools/tcptop: Use fentry/fexit for tcp_sendmsg  Replace kprobe/kretprobe with fentry/fexit hooks for tcp_sendmsg.  Signed-off-by: Ze Huang <huang.ze@linux.dev>,https://github.com/iovisor/bcc/commit/e2c79176af4c420772d9d8f5ec40b4c67f5b8c98
iovisor/bcc,https://github.com/iovisor/bcc,75bb73a,Ze Huang,2025-07-20T13:20:18Z,"tools/tcptop: Move original tcptop to old directory  The original tcptop uses kprobes on tcp_sendmsg and tcp_cleanup_rbuf to trace TCP-level send and receive statistics. However, the current receive side tracing via tcp_cleanup_rbuf can result in overcounting due to the way `copied` is used:      int tcp_recvmsg(...) {          ...          int copied = 0;          ...          do {              ...              tcp_cleanup_rbuf(sk, copied);              ...              copied += used;              ...          } while (len > 0);           tcp_cleanup_rbuf(sk, copied);          return copied;          ...     }      Same data in ""copied"" might be taken into account several times  Fixing this requires tracing tcp_recvmsg entry/exit, which kretprobe can't reliably handle due to maxactive limits. fentry/fexit is needed, but only available on kernels >= 5.5 with BTF.  Move the old version to tools/old/, and introduce a new version using fentry/fexit.  Reported-by: @sc07kvm <github.com/sc07kvm> Signed-off-by: Ze Huang <huang.ze@linux.dev>",https://github.com/iovisor/bcc/commit/75bb73a594a6083977652d6c26ec59cde8816d5a
iovisor/bcc,https://github.com/iovisor/bcc,867f4a0,zcy,2025-07-23T23:30:55Z,"tools: add softirqslower (#5356)  Summary ======= Adds softirqslower tool to trace softirq execution performance issues by measuring:     SoftIRQ Runtime: Handler execution duration     HardIRQ-to-SoftIRQ Latency: Delay between wakeup (trigger) and execution start  Motivation ======== Diagnosing network latency/stalls requires observing:     Slow softirq executions (e.g., >10ms NET_RX processing)     Scheduling delays where softirqs get preempted after wakeup  Signed-off-by: chenyuezhou <zcy.chenyue.zhou@gmail.com>",https://github.com/iovisor/bcc/commit/867f4a08d0d1f0c103dba9b442607910293e503f
iovisor/bcc,https://github.com/iovisor/bcc,e12cf0f,vongosling,2025-07-23T22:10:55Z,Update INSTALL.md (#5376)  Fix the bug according to Windows branch regulation,https://github.com/iovisor/bcc/commit/e12cf0f11dc78d1503e3e2bb7f5149779587dd85
iovisor/bcc,https://github.com/iovisor/bcc,982b7d3,Jerome Marchand,2025-07-18T12:15:46Z,"libbpf-tools/klockstat: Disable *_nested kprobes in the fentry code  Commit 789e923f (""libbpf-tools/klockstat: Allows kprobe fallback to work with lock debugging (#5359)"") add new kprobes to be enabled on debug kernel and disabled on normal kernel. But it forgot to disable them in the fentry code, along with other kprobes.  Disable *_nested kprobes in the fentry code.  Fixes: 789e923f (""libbpf-tools/klockstat: Allows kprobe fallback to work with lock debugging (#5359)"") Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/982b7d357f344934f796e0808d65af245cfc485a
iovisor/bcc,https://github.com/iovisor/bcc,694de9f,Rong Tao,2025-06-30T08:11:20Z,"libbpf-tools: trace_helpers: add str_loadavg() and str_timestamp()  There are many tools read /proc/loadavg and timestamp, this commit add two common function str_loadavg() and str_timestamp().  And fix bashreadline timestamp's wrong format, %m is month, should be %M (min).  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/694de9f98ec4b98b55bfb1df08bb528ff30be38d
iovisor/bcc,https://github.com/iovisor/bcc,8d066f0,yonghong-song,2025-07-16T19:00:09Z,Add @ekyooo as the official bcc reviewer (#5372),https://github.com/iovisor/bcc/commit/8d066f03f5f5a8618441827f3da46b8c8794785f
iovisor/bcc,https://github.com/iovisor/bcc,8c5c96a,yonghong-song,2025-07-15T03:21:59Z,"Fix a build failure with clang21 (#5369)  The build error message:   src/cc/frontends/clang/loader.cc:400:73: error: no matching function for    call to ‘clang::TextDiagnosticPrinter::TextDiagnosticPrinter(      llvm::raw_fd_ostream&, clang::DiagnosticOptions*)’   400 |   auto diag_client = new TextDiagnosticPrinter(llvm::errs(), &*diag_opts);       |                                                                         ^ The llvm commit   https://github.com/llvm/llvm-project/pull/139584 caused the build failure.  Adjust the code properly and the error is fixed.",https://github.com/iovisor/bcc/commit/8c5c96ad3beeed2fa827017f451a952306826974
iovisor/bcc,https://github.com/iovisor/bcc,b8b76e9,Yuzhou-Fang,2025-07-15T00:31:15Z,add descriptions for using pid in attach_uprobe and attach_uretprobe. (#5367)  Add descriptions in docs/reference_guide.md for using pid in attach_uprobe and attach_uretprobe functions that allows uprobes to be attached to a specific process. The introduced contents were mainly referred by the comments of attach_probe function in bcc/src/python/bcc/__init__.py.,https://github.com/iovisor/bcc/commit/b8b76e9a65df3ba772716522d5f4c944c6d43e4a
iovisor/bcc,https://github.com/iovisor/bcc,3630581,Jerome Marchand,2025-07-15T00:25:38Z,"tools/{biolatency,biosnoop,biotop}: use TRACEPOINT_PROBE() for tracepoints (#5366)  When support for block_io_* tracepoint was added, it used attach_tracepoint() since it was closer to the existing code that attached to kprobes. However, that meant we have to rely on a local prototype of the args structure and  the tool can be broken by a change of the tracepoints format, which is what happens with kernel commit aa6ff4eb7c10d (""block: Add ioprio to block_rq tracepoint"") which added a new argument to block tracepoints.  Replace attach_tracepoint() by TRACEPOINT_PROBE() so we don't have to deal with the tracepoint format changes.  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/36305815b927828592ae3b4f7f5a26aa82bc13ba
iovisor/bcc,https://github.com/iovisor/bcc,c8ad35a,yonghong-song,2025-07-14T23:54:22Z,Cleanup CODEOWNERS file (#5368),https://github.com/iovisor/bcc/commit/c8ad35aab9d6209f98021ea68f248182c5b805ad
iovisor/bcc,https://github.com/iovisor/bcc,78423e1,rockyxing,2025-07-14T17:52:24Z,"Add support for executing a program and tracing it (#5362)  For short-lived processes, specify '-p pid' is difficult to trace. Add support for executing a program and tracing it. When the newly child process exits, tool itself exists subsequently.  Added to syscount/opensnoop tools this time, other tools as needed.  For example: ./syscount.py -i 1 --exec ls -l /tmp",https://github.com/iovisor/bcc/commit/78423e1667db202012bbb032c567589175a2796c
iovisor/bcc,https://github.com/iovisor/bcc,21143df,Rong Tao,2025-07-14T16:32:35Z,libbpf-tools/ksnoop: Remove useless and white lines (#5365)  Remove useless and white lines in libbpf-tools/ksnoop.  Signed-off-by: Rong Tao <rongtao@cestc.cn>,https://github.com/iovisor/bcc/commit/21143df6abdb8ccb2be7df85a3a36e037239ddd5
iovisor/bcc,https://github.com/iovisor/bcc,a9c6650,Stefan Walter,2025-07-13T17:24:03Z,syscall_helpers.c / syscall.py: update syscall list (#5363)  Based on the Linux x86_64 source code (arch/x86/entry/syscalls/syscall_64.tbl).,https://github.com/iovisor/bcc/commit/a9c6650e391e812c03689ba706cf426dd2b234d4
iovisor/bcc,https://github.com/iovisor/bcc,5640952,yonghong-song,2025-07-13T16:14:32Z,"Fix potential verification failure for opensnoop.py (#5364)  When testing https://github.com/iovisor/bcc/pull/5362, I found the following verification failure for fentry progs:    ...   44: (b7) r0 = 0                       ; R0_w=0 refs=3   45: (95) exit   Unreleased reference id=3 alloc_insn=10  The reason is missing `ringbuf_discard` for certain conditionals for fentry progs since it used `ringbuf_reserve`. Adding `ringbuf_discard` in proper places can fix verification failure.",https://github.com/iovisor/bcc/commit/564095260aab156782128ea1d04b1eca66167fd1
iovisor/bcc,https://github.com/iovisor/bcc,0ae562c,Rong Tao,2025-07-13T04:26:14Z,"libbpf-tools: ksnoop: Fix two invalid access to map value (#5361)  On fedora42, llvm 20.1.7, kernel 6.15.4-200.fc42.x86_64 has two verifier errors. Test with command:      $ sudo ./ksnoop trace do_sys_openat2  1st:     ; last_stack_depth = stack_depth - 1; @ ksnoop.bpf.c:102     108: (bc) w3 = w6                     ; frame1: R3_w=scalar(id=5,smin=smin32=0,smax=umax=smax32=umax32=14,var_off=(0x0; 0xf)) R6=scalar(id=5,smin=smin32=0,smax=umax=smax32=umax32=14,var_off=(0x0; 0xf))     109: (04) w3 += -1                    ; frame1: R3_w=scalar(smin=0,smax=umax=0xffffffff,smin32=-1,smax32=13,var_off=(0x0; 0xffffffff))     110: (bc) w4 = w3                     ; frame1: R3_w=scalar(id=6,smin=0,smax=umax=0xffffffff,smin32=-1,smax32=13,var_off=(0x0; 0xffffffff)) R4_w=scalar(id=6,smin=0,smax=umax=0xffffffff,smin32=-1,smax32=13,var_off=(0x0; 0xffffffff))     111: (54) w4 &= 255                   ; frame1: R4_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=255,var_off=(0x0; 0xff))     112: (b7) r7 = 0                      ; frame1: R7=0     ; if (last_stack_depth >= 0 && @ ksnoop.bpf.c:104     113: (26) if w4 > 0xf goto pc+5       ; frame1: R4=scalar(smin=smin32=0,smax=umax=smax32=umax32=15,var_off=(0x0; 0xf))     ; last_ip = func_stack->ips[last_stack_depth]; @ ksnoop.bpf.c:106     114: (57) r3 &= 255                   ; frame1: R3_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=255,var_off=(0x0; 0xff))     115: (67) r3 <<= 3                    ; frame1: R3_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=2040,var_off=(0x0; 0x7f8))     116: (bf) r4 = r2                     ; frame1: R2=map_value(map=ksnoop_func_sta,ks=8,vs=144) R4_w=map_value(map=ksnoop_func_sta,ks=8,vs=144)     117: (0f) r4 += r3                    ; frame1: R3_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=2040,var_off=(0x0; 0x7f8)) R4_w=map_value(map=ksnoop_func_sta,ks=8,vs=144,smin=smin32=0,smax=umax=smax32=umax32=2040,var_off=(0x0; 0x7f8))     118: (79) r7 = *(u64 *)(r4 +8)     invalid access to map value, value_size=144 off=2048 size=8      The last_stack_depth use 'w4 > 0xf' check boundary, but 'r3 &= 255'     is beyond 0xf (0~15).  2nd:     ; trace_len = sizeof(*trace) + trace->buf_len - MAX_TRACE_BUF; @ ksnoop.bpf.c:222     502: (04) w5 += 4008                  ; frame1: R5_w=scalar(smin=umin=smin32=umin32=4009,smax=umax=smax32=umax32=0x10fa7,var_off=(0x0; 0x1ffff))     503: (bc) w2 = w5                     ; frame1: R2_w=scalar(id=27,smin=umin=smin32=umin32=4009,smax=umax=smax32=umax32=0x10fa7,var_off=(0x0; 0x1ffff)) R5_w=scalar(id=27,smin=umin=smin32=umin32=4009,smax=umax=smax32=umax32=0x10fa7,var_off=(0x0; 0x1ffff))     504: (54) w2 &= 65535                 ; frame1: R2_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=0xffff,var_off=(0x0; 0xffff))     ; if (trace_len <= sizeof(*trace)) @ ksnoop.bpf.c:224     505: (26) if w2 > 0x3fa8 goto pc+7    ; frame1: R2_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=16296,var_off=(0x0; 0x3fff))     506: (57) r5 &= 65535                 ; frame1: R5_w=scalar(smin=smin32=0,smax=umax=smax32=umax32=0xffff,var_off=(0x0; 0xffff))     507: (18) r2 = 0xffff8ec554700c00     ; frame1: R2_w=map_ptr(map=ksnoop_perf_map,ks=4,vs=4)     509: (18) r3 = 0xffffffff             ; frame1: R3_w=0xffffffff     511: (bf) r4 = r9                     ; frame1: R4_w=map_value(map=ksnoop_func_map,ks=8,vs=16296) R9=map_value(map=ksnoop_func_map,ks=8,vs=16296)     512: (85) call bpf_perf_event_output#25     invalid access to map value, value_size=16296 off=0 size=65535      Just fix it with size type 'u64' instead of 'u32', see:     long bpf_perf_event_output(void *ctx, struct bpf_map *map, u64 flags, void *data, u64 size)  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/0ae562c8862f4aa7a028a3f9bc561636a63a507d
iovisor/bcc,https://github.com/iovisor/bcc,789e923,Jerome Marchand,2025-07-13T04:12:33Z,"libbpf-tools/klockstat: Allows kprobe fallback to work with lock debugging (#5359)  The klockstat tool fallback on kprobes when fentries are not available, but the fallback doesn't work on debug kernel (CONFIG_DEBUG_LOCK_ALLOC enabled).  Attach kprobes to the debug locking functions (*_nested) when they exists as is done with the fentry code.  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/789e923fc9fda909c74d25025dc5411e2819f75f
iovisor/bcc,https://github.com/iovisor/bcc,5f7bcb3,Bojun Seo,2025-07-13T03:21:01Z,libbpf-tools/memleak: fix typo (#5358)  Fix a typo in libbpf-tools/memleak.,https://github.com/iovisor/bcc/commit/5f7bcb363d014743b8dd42b65c19700094bc2148
iovisor/bcc,https://github.com/iovisor/bcc,6bd2760,hsadinen,2025-07-13T03:20:08Z,bcc:  Fix for test tools_memleak.py (#5355)  Fixes tools_memleak.py which is getting failed due to c_src_full = os.path.dirname(sys.argv[0]) + os.path.sep + c_src is giving  /'test_tools_memleak_leaker_app.c.  Signed-off-by: Harish Sadineni <Harish.Sadineni@windriver.com>,https://github.com/iovisor/bcc/commit/6bd2760a06665021d97306fa86eb871ea99606ae
iovisor/bcc,https://github.com/iovisor/bcc,af21da6,Rong Tao,2025-07-13T02:52:42Z,"libbpf-tools/filelife: Fix wrong full-path (#5347)  The process that creates the file and the process that deletes the file may be two completely different processes, and their cwds are different. We get the file name from the file dentry and concatenate the cwd to create the full-path. If we use the dentry name of the deleted file + the cwd-dentry of the process that created the file, we will get an incorrect full-path. For example:      $ realpath .     /home/sda/git-repos/iovisor/bcc/libbpf-tools      (1) correct full-path      $ touch a.out               cwd_dentry = /home/sda/git-repos/iovisor/bcc/libbpf-tools     $ cd ..     $ rm libbpf-tools/a.out     dentry = a.out      (2) wrong full-path      $ touch libbpf-tools/a.out  cwd_dentry = /home/sda/git-repos/iovisor/bcc/     $ cd libbpf-tools/     $ rm a.out                  dentry = a.out      $ sudo ./filelife -F     Tracing the lifespan of short-lived files ... Hit Ctrl-C to end.     TIME     PID    COMM  AGE(s)  FILE     08:56:30 13015  rm    5.17    /home/sda/git-repos/iovisor/bcc/libbpf-tools/a.out (1)     08:56:45 13075  rm    5.17    /home/sda/git-repos/iovisor/bcc/a.out              (2)  In fact, we do not need to record the cwd-dentry of the process that created the file. We only need to pass the dentry of the deleted file as the dentry parameter of bpf_dentry_full_path(). Of course, the vfsmount of cwd still needs to be obtained when creating it.  Fix: commit 74bddcbe646e (""libbpf-tools/filelife: support full-path"")  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/af21da6f7a61416c7d993b9f3d82a14137259259
iovisor/bcc,https://github.com/iovisor/bcc,ac3eda9,Jordan Chiu,2025-07-13T02:48:07Z,"net_monitor: fix typos in comments (#5360)  Corrects spelling errors in comments: - ""retrieeve"" → ""retrieve"" - ""entires"" → ""entries"" - ""confiremd"" → ""confirmed""  These minor fixes improve code readability and maintain documentation quality in the BCC example.  Signed-off-by: Chia-Hao Chiu <jordan871130@gmail.com>",https://github.com/iovisor/bcc/commit/ac3eda965cf198831045aa00d22251bfdcf85471
iovisor/bcc,https://github.com/iovisor/bcc,673911c,chudihuang,2025-06-10T13:19:39Z,"libbpf-tools: runqslower: add -c option to filter by process name prefix  Add -c option to filter by process name prefix. This allows tracing all processes whose command name prefix matches the specified string.  For example, to trace all processes with names starting with ""ksoftirq"" on the system:      runqslower -c ksoftirq 1000  Sample output:     Tracing run queue latency higher than 1000 us     TIME     COMM             TID           LAT(us)     19:41:19 ksoftirqd/1      16               2357     19:41:19 ksoftirqd/0      9                2020     19:41:20 ksoftirqd/1      16               1811     19:41:20 ksoftirqd/1      16               2344     19:41:23 ksoftirqd/1      16               1517     19:41:23 ksoftirqd/1      16               1120",https://github.com/iovisor/bcc/commit/673911cfedbd4a274fe55f5c8a9b6582218beec5
iovisor/bcc,https://github.com/iovisor/bcc,2f3361c,yonghong-song,2025-06-30T16:26:04Z,libbpf-tools: Fix the license for newly added path* files (#5346)  Change the license from   SPDX-License-Identifier: GPL-2.0 to   SPDX-License-Identifier: (LGPL-2.1 OR BSD-2-Clause)  The later is more compatible for userspace tools.  Co-authored-by: Yonghong Song <yonghong.song@linux.dev>,https://github.com/iovisor/bcc/commit/2f3361c6fd361bc5e7424df21671d728e98d55c3
iovisor/bcc,https://github.com/iovisor/bcc,137bd5f,SRIVATHSA DARA,2025-06-27T19:19:28Z,tools/filetop: Add directory filter (#5300)  Add support to filtop to filter by directory.  Signed-off-by: Srivathsa Dara <srivathsa.d.dara@oracle.com>,https://github.com/iovisor/bcc/commit/137bd5fbc6f7c779ef81f8627fe69552ce4c297b
iovisor/bcc,https://github.com/iovisor/bcc,9adce7a,ekyooo,2025-06-26T18:40:37Z,libbpf-tools/syscall_helpers: Modify syscall_name to return error code (#5314)  Allow callers to handle errors via return value instead of parsing the buffer.,https://github.com/iovisor/bcc/commit/9adce7ad383d963edfb60224daedeb7183c26101
iovisor/bcc,https://github.com/iovisor/bcc,939828c,Ism Hong,2025-06-24T21:49:32Z,"tools/runqlat: Dynamically size pid/pidns histogram map (#5342)  When using `runqlat` with the `--pids` or `--pidnss` flags, the BPF histogram for tracking per-process or per-namespace latency is created with a fixed default size of 64 entries.  On systems with a large number of processes or active namespaces, this small, fixed size can be easily exhausted. This leads to silent data loss for any PIDs or PID namespaces beyond the 64th entry, making the tool's output incomplete and misleading.  To fix this, read the maximum possible PID and PID Namespace values from `/proc/sys/kernel/pid_max` and `/proc/sys/user/max_user_namespaces` respectively. Pass these values to the BPF program to dynamically size the histogram map, ensuring it is large enough to avoid dropping data.  This approach is similar to the one implemented for cpudist as discussed in PR #2568.  Link: https://github.com/iovisor/bcc/pull/2568  Signed-off-by: Ism Hong <ism.hong@gmail.com>",https://github.com/iovisor/bcc/commit/939828c400ef4e379e1313ba0d3cbed761ce3a1a
iovisor/bcc,https://github.com/iovisor/bcc,74bddcb,Rong Tao,2025-06-22T08:37:38Z,"libbpf-tools/filelife: support full-path  To support full-path, the following operations are performed:  1. First, to support the transmission of larger data, perf-buffer is    replaced with ring-buff. 2. Then, before this patch, events are constructed in kprobe/unlink,    and events of successful unlink are submitted in kretprobe/unlink.    However, the reservation and submission of ring-buff cannot be    separated, so the struct unlink_event small structure is introduced    for transfer, and the reservation and submission of events are in    kretprobe/unlink. 3. In order to record the dentry and vfsmount structures of cwd when the    file is created, the structure struct create_arg{} is introduced.    Note: cannot obtain the dentry and vfsmount structures of cwd in    kretprobe/unlink.  Example:     # Test commands     $ cd /home/sda/git-repos/     $ touch a.out && sleep 0.2 && rm a.out      # before     $ sudo ./filelife     Tracing the lifespan of short-lived files ... Hit Ctrl-C to end.     TIME     PID    COMM             AGE(s)  FILE     17:27:05 458702 rm               0.21    a.out      # after     $ sudo ./filelife -F     Tracing the lifespan of short-lived files ... Hit Ctrl-C to end.     TIME     PID    COMM             AGE(s)  FILE     17:26:58 458692 rm               0.21    /home/sda/git-repos/a.out                                              ^^^^^^^^^^^^^^^^^^^^ full-path  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/74bddcbe646eb8a1595067f8c698f7d0416c90fb
iovisor/bcc,https://github.com/iovisor/bcc,ab8e061,Rong Tao,2025-06-22T06:21:55Z,"libbpf-tools: Introduce path helpers  There will be many programs that need to get the current working directory or full-path of file, such as opensnoop, which is already supported. and other tools like filelife/filetop need it too.  Therefore, it will be helpful to separate the bpf_getcwd function from opensnoop.bpf.c as a public helper function.  Add functions:   1. bpf_dentry_full_path(): Get the full-path based on the dentry and                              vfsmount.   2. bpf_getcwd(): Get the full-path of the current working directory.   3. print_full_path(): Assembling full-path in user space.  Add structures:   1. struct full_path {}: Record the absolute path.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/ab8e0616e88b9e1ba92520c6d041ae9214b10cf6
iovisor/bcc,https://github.com/iovisor/bcc,d1faaf3,Rong Tao,2025-06-24T02:53:11Z,"tools/opensnoop: support mount full-path (#5339)  Like libbpf-tools/opensnoop [1] did, get mount parent full-path.  [1] https://github.com/iovisor/bcc/pull/5333     https://github.com/iovisor/bcc/commit/6291ff5241e7  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/d1faaf3df443fe8d45eb1f34a7d50592023f6d02
iovisor/bcc,https://github.com/iovisor/bcc,8e3a1d3,Rong Tao,2025-06-21T15:54:59Z,"tools/opensnoop: one event is enough for full-path (#5334)  Each loop iteration of dentry will send out an event [1], which is too much and unnecessary.  1. Use ringbuf instead of perf buffer. Because the event transmitted at one    time is large and the stack space is insufficient, the reservation function    of ringbuf is used. And, ringbuf is wildly supported. 2. Each full-path transmits only one event, eliminating unnecessary events. It's    good for further developement.  [1] https://github.com/iovisor/bcc/commit/c110a4dd0c8f  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/8e3a1d33c50eac53941d8755c52cebe2df58e798
iovisor/bcc,https://github.com/iovisor/bcc,7c4cf38,Gang Yan,2025-06-18T21:05:26Z,"Bcc: mptcpify: add the NULL check for variable 'mode' (#5336)  Recently, the mptcpify meets an error in some OS, the error is caused by the EBPF code of mptcpify. The error message is attached below:  ''' ... ; (*mode == 0 || bpf_map_lookup_elem((void *)bpf_pseudo_fd(1, -2), &target)) 30: (61) r1 = *(u32 *)(r6 +0) ... HINT: The 'map_value_or_null' error can happen if you deference a pointer value from a map lookup without first checking if that pointer is NULL. ... Exception: Failed to load BPF program b'kmod_ret__updatesocket_protocol': Permission denied '''  The error is caused by variable 'mode' is used without check, so this patch can fix the problem.  Signed-off-by: Gang Yan <yangang@kylinos.cn>",https://github.com/iovisor/bcc/commit/7c4cf38828638a976da9e20a2cb737772536839e
iovisor/bcc,https://github.com/iovisor/bcc,6291ff5,Rong Tao,2025-06-15T21:00:55Z,"libbpf-tools/opensnoop: support mount full-path (#5333)  Like d_path()/prepend_path() [1] did, get mount parent full-path. Although full-path support is added in [2], when there is a mount point in the path, [2] does not display the true full-path, for example:  /dev/sda mount on /home/sda/:      $ mount | grep sda     /dev/sda on /home/sda type xfs ...      $ cd /home/sda/rongtao/     $ touch a.out      $ sudo ./opensnoop -F | grep touch -w     PID    COMM              FD ERR PATH     216942 touch              3   0 /rongtao/a.out                                     ^^^^^^^^^^^^^^  This patch will handle the mount points, tracking the real full-path:      $ sudo ./opensnoop -F     PID    COMM              FD ERR PATH     216568 touch              3   0 /home/sda/rongtao/a.out                                     ^^^^^^^^^  [1] https://github.com/torvalds/linux/blob/master/fs/d_path.c [2] https://github.com/iovisor/bcc/commit/b1c5548d4763  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/6291ff5241e75cabb925bb023746ba389dc69120
iovisor/bcc,https://github.com/iovisor/bcc,2f77081,Po-Ying Chiu,2025-06-15T18:56:30Z,fix typo in README.md (#5335)  fix typo in README.md: readed -> read  Signed-off-by: Po-Ying Chiu <charlie910417@gmail.com>,https://github.com/iovisor/bcc/commit/2f77081d826e4b94429f5bc222da208b81d38f95
iovisor/bcc,https://github.com/iovisor/bcc,ee3ba78,云微,2025-06-12T05:40:18Z,"libbpf-tools/offcputime: fix min or max_block_ns unit (#5327)  The current implementation make it in us, not in ns.  Signed-off-by: Yusheng Zheng <yunwei356@gmail.com>",https://github.com/iovisor/bcc/commit/ee3ba7806e5179a2d8e252c4c17c49483670b62b
iovisor/bcc,https://github.com/iovisor/bcc,26eaf13,isabert,2025-06-12T05:31:38Z,"removing luajit options to ensure no errors will be thrown when running (#5326)  Tested using ubuntu noble, with all dependencies installed. When running the command in INSTALL.md > source > Ubuntu    cmake ..    make  Errors are caused by non-existent luajit options  [  1%] Built target clang_frontend-objects [  1%] Built target clang_frontend [ 11%] Built target bpf-static [ 12%] Built target api-static [ 13%] Built target usdt-static [ 18%] Built target bcc-shared [ 20%] Built target bcc-loader-static [ 21%] Built target api-objects [ 27%] Built target bcc-static [ 37%] Built target bpf-shared [ 37%] Built target bcc_py_python3 [ 37%] Generating bcc.o Save LuaJIT bytecode: luajit -b[options] input output   -l        Only list bytecode.   -s        Strip debug info (default).   -g        Keep debug info.   -n name   Set module name (default: auto-detect from input name).   -t type   Set output file type (default: auto-detect from output name).   -a arch   Override architecture for object files (default: native).   -o os     Override OS for object files (default: native).   -F name   Override filename (default: input filename).   -e chunk  Use chunk string as input.   --        Stop handling options.   -         Use stdin as input and/or stdout as output.  File types: c cc h obj o raw (default) make[2]: *** [src/lua/CMakeFiles/bcc-lua.dir/build.make:74: src/lua/bcc.o] Error 1 make[1]: *** [CMakeFiles/Makefile2:1072: src/lua/CMakeFiles/bcc-lua.dir/all] Error 2 make: *** [Makefile:146: all] Error 2",https://github.com/iovisor/bcc/commit/26eaf13bbcf89f0d73b5b0043f5905cac08039d4
iovisor/bcc,https://github.com/iovisor/bcc,b1c5548,Rong Tao,2025-06-12T05:26:20Z,"libbpf-tools: opensnoop: add full-path argument -F (#5323)  This patch implements full-path, which tracks the full path of an open file when the -F,--full-path parameter is specified.  The implementation differs from patch [1] in that full path data is transmitted at one event rather than in multi events.  For example:      $ cd /var/tmp/     $ touch a.out      $ sudo ./opensnoop -F     PID    COMM              FD ERR PATH     106779 touch              3   0 /var/tmp/a.out                                     ^^^^^^^^^^^^^^  Because the transmitted data is very large, it is not possible to define the variable ""struct event = {};"" in stack, so the event data is reserved in the way of bpf_buffer+heap.  Link: https://github.com/iovisor/bcc/commit/c110a4dd0c8f [1]  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/b1c5548d476388ea37270762bb168b3eb10ba4bf
iovisor/bcc,https://github.com/iovisor/bcc,bbb8df9,Aayush garg,2025-06-08T16:31:19Z,"Added functionality to detach all uprobes for a binary (#5325)  Added a new method in BCC  StatusTuple BPF::detach_all_uprobes_for_binary(const std::string& binary_path)  This method detaches all uprobe probes that are associated with the given binary path. It works by matching the sanitized binary path against the event names of all currently attached uprobes, and detaches any that match. Importantly, this function does not check if the binary file still exists on disk; it simply removes all matching uprobes from the internal tracking and from the kernel.  This is useful for cleaning up probes that may otherwise remain attached if the binary is deleted or moved, or if you want to forcibly remove all uprobes for a specific binary regardless of its current presence on the filesystem.  Use Case  Automatic Cleanup When a Binary is Deleted:  If a monitored binary is removed from the filesystem, any uprobes attached to it will remain active in the kernel unless explicitly detached. This function allows you to clean up all such probes, preventing resource (fd) leaks and potential errors.  Bulk Detachment:  When updating or replacing a binary, you may want to remove all associated uprobes before re-attaching new ones. This function provides a simple way to do so without needing to track individual probe details.  Example:  Suppose you are tracing a user-space binary /proc//exe and that binary is deleted still you can call:  bpf.detach_all_uprobes_for_binary(""/proc/<program-pid>/exe"");  This will remove all uprobes associated with stoped program-pid , even if the file no longer exists, ensuring no stale probes are left behind.  With this functionality #4843 will fixed",https://github.com/iovisor/bcc/commit/bbb8df9822ba3abc1b853267c27291ebee1888f8
iovisor/bcc,https://github.com/iovisor/bcc,4bc4858,Phoenix,2025-06-07T01:53:29Z,Doc/dead links (#5322)  doc: remove some dead links in LINKS.md  Closes: #5318 Also add a CI to check dead links.  Signed-off-by: Jiawei Zhao <Phoenix500526@163.com>,https://github.com/iovisor/bcc/commit/4bc48581dfd4c6973148e128156e9806b01b2d9a
iovisor/bcc,https://github.com/iovisor/bcc,c31a1ca,yonghong-song,2025-05-30T03:09:17Z,"Update debian changelog for release v0.35.0 (#5321)  * Support for kernel up to 6.14   * New bcc tools: mptcp: enable mptcp for tcp traffic   * tools/biosnoop: Fix biosnoop pattern option   * Allow cmake run out of the source tree   * Fix for test bpf_stack_id when running on custom image in yocto   * libbpf-tools/map_helpers: Add bpf_map_lookup_and_delete_batch to dump_hash   * libbpf-tools/biotop: Use dump_hash for map processing   * uninstall: use execute_process() instead of exec_program()   * clang: Fix pointer dereference on big-endian machines   * ci: Upgrade to ubuntu 24.04   * doc update, other bug fixes and example improvement.",https://github.com/iovisor/bcc/commit/c31a1ca305f787ba53e001ead45ebf65233a32cf
iovisor/bcc,https://github.com/iovisor/bcc,3ea1d7f,yonghong-song,2025-05-30T02:32:09Z,"Sync with latest libbpf repo (#5320)  The top upstream libbpf commit is    commit 02bdeb7a2c2e7cb2c9cecb125527a9c5a6bbf139 (HEAD -> master, origin/master, origin/HEAD)   Author: Mykyta Yatsenko <yatsenko@meta.com>   Date:   Mon May 19 13:54:21 2025 +0100      sync: latest libbpf changes from kernel  Co-authored-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/3ea1d7fa23c385150c9734c9f80fa6ee96d9f21a
iovisor/bcc,https://github.com/iovisor/bcc,fbe2864,Kirill Spitsyn,2025-05-29T17:34:21Z,"Add missing install dependencies to INSTALL.md (#5319)  Just tried to build bcc on a today's debian-sid-nocloud-amd64-daily.raw, and it first failed with:  ``` [...] [ 18%] Building CXX object src/cc/CMakeFiles/bcc-shared.dir/common.cc.o                                                                                                                                               make[2]: *** No rule to make target '/usr/lib/llvm-19/lib/libPolly.a', needed by 'src/cc/libbcc.so.0.34.0'.  Stop.                                                                                                    make[1]: *** [CMakeFiles/Makefile2:1043: src/cc/CMakeFiles/bcc-shared.dir/all] Error 2                                                                                                                                make: *** [Makefile:146: all] Error 2  ```  That got fixed with `apt install libpolly-19-dev`, but the build failed with  ``` [ 92%] Built target debuginfo_test_lib [ 93%] Generating archive.zip /bin/sh: 1: zip: not found make[2]: *** [tests/cc/CMakeFiles/zip_archive.dir/build.make:75: tests/cc/archive.zip] Error 127 make[1]: *** [CMakeFiles/Makefile2:2166: tests/cc/CMakeFiles/zip_archive.dir/all] Error 2 make: *** [Makefile:146: all] Error 2 ```  That got fixed with `apt install zip`.",https://github.com/iovisor/bcc/commit/fbe2864779130a0f8aced13ffec4f591dcb78533
iovisor/bcc,https://github.com/iovisor/bcc,d7667cf,Sumanth Korikkar,2025-05-20T16:13:37Z,"clang: Fix pointer dereference on big-endian machines (#5287)  When pointer is dereferenced, it ends up with bpf_probe_read_kernel(). However, the data type of source and destination might differ in size for genParamIndirectAssign() and this can cause endianness issue.  Fix the pointer dereference by adjusting offsets of source and destination, when there is a size disparity. Also, as a small optimization, perform memset() only on the required destination part, considering the endianness.  * This is specifically needed for the genParamIndirectAssign(), where size disparity could happen. With the patch, the code generated is shown below:  __attribute__((section("".bpf.fn.syscall__kill""))) int syscall__kill(struct pt_regs *ctx) {  struct pt_regs * __ctx = (void *)ctx->gprs[2];  int tpid; BCC_PROBE_READ(&tpid, &__ctx->orig_gpr2, bpf_probe_read_kernel);  int sig; BCC_PROBE_READ(&sig, &__ctx->gprs[3], bpf_probe_read_kernel); ...  Here ctx->gprs[3] is 64 bit and sig is 32 bit and there is a size disparity.  * However, in other usecases like VisitMemberExpr() etc, The code generated is as below: if (flags & O_CREAT || (flags & O_TMPFILE) == O_TMPFILE) mode = ({     typeof(__u64) _val; __builtin_memset(&_val, 0, sizeof(_val));     bpf_probe_read_kernel(&_val, sizeof(_val), (void *)&how->mode); _val; });  The code uses typeof(__u64) to create a temporary variable (_val) that matches the size of the data being read. This prevents mismatch between the source and destination sizes and hence changes are not necessary in these usecases.  The fix is based on linux commit: 2e2c6d3fb383 (""selftests/bpf: Fix test_core_reloc_mods on big-endian machines"")  Signed-off-by: Sumanth Korikkar <sumanthk@linux.ibm.com>",https://github.com/iovisor/bcc/commit/d7667cf92ed841fec467ce4b701adf42bb9422f6
iovisor/bcc,https://github.com/iovisor/bcc,78580e0,ekyooo,2025-05-20T16:03:40Z,libbpf-tools/memleak: Extract print_headers (#5313)  Extract the print_headers logic into a separate function to improve code maintainability and extensibility.,https://github.com/iovisor/bcc/commit/78580e029896bcea31299e630a4ca6e9c26d25f3
iovisor/bcc,https://github.com/iovisor/bcc,a434ee5,yonghong-song,2025-05-19T06:34:10Z,"ci: Install python3-setuptools for ubuntu 24.04 (#5312)  For ubuntu 24.04, setuptools is not installed by default. So let us install it during Dockerfile.ubuntu preparation. Also, pip3 installation is replaced with package installation  so we do not need venv any more.  Co-authored-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/a434ee50522ee73b79468a88880b9cae28de53bd
iovisor/bcc,https://github.com/iovisor/bcc,82c212f,GengWu,2025-05-19T04:09:50Z,"Fix the issue where xfsslower cannot track write operations on files opened with the O_SYNC flag (#5310)  This patch fixes an issue in xfsslower where write operation traces are overwritten when files are opened with O_SYNC flag. Currently, when a file is opened with O_SYNC, xfsslower fails to track write operations and only shows sync operations. For example, when testing XFS I/O using this fio command:  [xxx@yyy ~]# fio --name=dsync-write --group_reporting --ioengine=psync --filename=./test --direct=1 --sync=1 --rw=write --bs=32k --size=4G --iodepth=1 --thread=1 --numjobs=1  And tracing with:  [xxx@yyy ~]# /usr/share/bcc/tools/xfsslower 0 The output only shows fsync operations without any write traces: 14:57:16 fio 189921 S 0 0 0.00 test 14:57:16 fio 189921 S 0 0 0.00 test 14:57:16 fio 189921 S 0 0 0.04 test  The root cause is that for O_SYNC files, xfs_file_write_iter calls xfs_file_fsync internally. This causes both trace_rw_entry and trace_fsync_entry to execute sequentially in the same process context.Since xfsslower uses BPF_HASH(entryinfo, u64, struct val_t) where entryinfo only uses pid and tid as keys, the entryinfo entry created by trace_rw_entry gets overwritten by trace_fsync_entry, making it impossible to track xfs_file_write_iter latency.  The solution introduces a new key structure:  struct key_t { u64 ptid; // pid and tid u32 type; // operation type };  All kprobe trace functions in xfsslower have been updated to work with the new key structure. After this change, xfsslower correctly tracks both xfs_file_write_iter and xfs_file_fsync latencies: 15:22:13 fio 190028 S 0 0 0.00 test 15:22:13 fio 190028 W 32768 2293504 0.05 test 15:22:13 fio 190028 S 0 0 0.00 test 15:22:13 fio 190028 W 32768 2293536 0.05 test  See the code changes in this commit for implementation details.",https://github.com/iovisor/bcc/commit/82c212fafd7c2dd2af786169ffc994f04036ecc2
iovisor/bcc,https://github.com/iovisor/bcc,10eb683,yonghong-song,2025-05-19T00:19:17Z,ci: Upgrade ubuntu 20.04 to 24.04 (#5311)  Currently CI does not work since ubuntu 20.04 is end-of-service. This patch upgraded ubuntu 20.04 to 24.04.  Co-authored-by: Yonghong Song <yonghong.song@linux.dev>,https://github.com/iovisor/bcc/commit/10eb683eec54e27faff0f512874785c39db02a0e
iovisor/bcc,https://github.com/iovisor/bcc,ed54880,Yonghong Song,2025-05-18T23:54:05Z,"Revert ""Use ubuntu 24.04 and fedora 41 for CI testing (#5301)""  This reverts commit 21b0b7668c2a8f7b3bedbfa3f01f87587be98b25.",https://github.com/iovisor/bcc/commit/ed548809a918621870e119f41f2a42d3dc2eec04
iovisor/bcc,https://github.com/iovisor/bcc,612e750,Yonghong Song,2025-05-18T23:53:51Z,"Revert ""Use correct nickname for github publish-build-containers.yml (#5305)""  This reverts commit f2d3803272fcd39888b75bb508df8f095ad02411.",https://github.com/iovisor/bcc/commit/612e7508855d24a257ebdd3da42dd001b43706a0
iovisor/bcc,https://github.com/iovisor/bcc,5a507f7,Rong Tao,2025-05-18T15:56:07Z,"uninstall: use execute_process() instead of exec_program() (#5285)  exec_program() is deprecated since 3.28, see: 'cmake --help-policy CMP0153', and cmake support execute_process() since CMake 2.6.0.      $ sudo make uninstall     ....     -- Uninstalling /usr/share/bcc/examples/networking/distributed_bridge/tunnel.py     CMake Warning (dev) at /home/rongtao/Git/bcc/build/CmakeUninstall.cmake:14 (exec_program):       Policy CMP0153 is not set: The exec_program command should not be called.       Run ""cmake --help-policy CMP0153"" for policy details.  Use the cmake_policy       command to set the policy and suppress this warning.        Use execute_process() instead.     Call Stack (most recent call first):       /home/rongtao/Git/bcc/build/CmakeUninstall.cmake:28 (UninstallManifest)     This warning is for project developers.  Use -Wno-dev to suppress it.  Link: https://cmake.org/cmake/help/v3.12/command/execute_process.html  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/5a507f7fc77f45825606a2753e6fa211edbde67c
iovisor/bcc,https://github.com/iovisor/bcc,00effe7,Eunseon Lee,2025-04-23T06:45:10Z,"libbpf-tools/biotop: Use dump_hash for map processing  Replace biotop's two-loop map lookup and deletion with a single dump_hash call, using bpf_map_lookup_and_delete_batch for atomic processing to prevent potential concurrency issues. Simplify code using dump_hash.",https://github.com/iovisor/bcc/commit/00effe7eecf24dd00e21dba8119b5b8baa34c0af
iovisor/bcc,https://github.com/iovisor/bcc,c4e8f3a,Eunseon Lee,2025-04-23T05:59:04Z,"libbpf-tools/map_helpers: Add bpf_map_lookup_and_delete_batch to dump_hash  Add support for bpf_map_lookup_and_delete_batch in dump_hash to enable atomic lookup and deletion, aiding tools like biotop with concurrency issues.",https://github.com/iovisor/bcc/commit/c4e8f3a39b97d8ac1a6e7424619ae544de1ad082
iovisor/bcc,https://github.com/iovisor/bcc,819c217,Harish sadineni,2025-05-18T04:07:28Z,"bcc: Fix for test bpf_stack_id when running on custom image in yocto (#5292)  The test for `bpf_stack_id` was failing due to the system being unable to locate `libc.so.6`. Upon investigation using `strace`, the following error was observed:   newfstatat(AT_FDCWD, ""/lib/x86_64-linux-gnu/libc.so.6"", 0x7ffdcd475420, 0) = -1 ENOENT (No such file or directory)   newfstatat(AT_FDCWD, ""/lib64/libc.so.6"", 0x7ffdcd475420, 0) = -1 ENOENT (No such file or directory)  This issue occurs because `libc.so.6` was not found in the expected locations. To resolve this, the location of `libc.so.6` has been added to the custom Yocto images. It is now accessible at: /lib/libc.so.6  This change ensures proper linking and access to `libc.so.6` during runtime in the Yocto custom image.  Signed-off-by: Harish Sadineni <Harish.Sadineni@windriver.com>",https://github.com/iovisor/bcc/commit/819c2170a77451df206cc79d1cd0603216f65ef7
iovisor/bcc,https://github.com/iovisor/bcc,7ca71ba,Jerome Marchand,2025-05-18T02:17:34Z,"clang: Define DCONFIG_CC_IS_CLANG in KBuildHelper::get_flags() (#5172) (#5293)  On powerpc, many tools fail with an ""invalid output constraint '=YZ<>' in asm"" error. This come from the following code in arch/powerpc/include/asm/asm-compat.h:  Because CONFIG_CC_IS_CLANG is not defined in the headers, we end up using a constraint that is not understoog by clang.  Defining CONFIG_CC_IS_CLANG in KBuildHelper::get_flags() fixes this error and possibly other similar error.  Suggested-by: Shung-Hsi Yu <shung-hsi.yu@suse.com> Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/7ca71ba7a2a6db09451c5339e23e9b6e96b3963b
iovisor/bcc,https://github.com/iovisor/bcc,f08c41d,Ilya Leoshkevich,2025-05-18T02:09:36Z,"Fix running cmake outside of the source subtree (#5299)  Configuring bcc in a build directory that is not in the source subtree causes the following warning:      warning: Not a git repository. Use --no-index to compare two paths outside a working tree  This is caused by a subcommand running in the current working directory. Run it in the source directory instead.  Fixes: 3df26a542f80 (""cmake: sync submodule libbpf when do cmake."")  Signed-off-by: Ilya Leoshkevich <iii@linux.ibm.com>",https://github.com/iovisor/bcc/commit/f08c41d5963e26d3b0d2db62acbf75cee4abb2bd
iovisor/bcc,https://github.com/iovisor/bcc,5504a05,bin-101,2025-05-17T23:51:36Z,tests/python: support finish_task_switch.isra.* (#5302)  Follow the approach introduced in https://github.com/iovisor/bcc/pull/3315.  Signed-off-by: Hitoshi Murakami <bin101bb@gmail.com>,https://github.com/iovisor/bcc/commit/5504a0529e0d21d48e4dd565b53b5cf05f88c1b5
iovisor/bcc,https://github.com/iovisor/bcc,9e6c020,Youngsuk Kim,2025-05-17T23:14:38Z,"Delete outdated comment (INSTALL.md; Ubuntu) (#5308)  Attached `bash` block has no direct references to `xenial`. Minor docs clean-up.",https://github.com/iovisor/bcc/commit/9e6c02036cae2e9f4a6ae8fe0b33e71cf4ac316a
iovisor/bcc,https://github.com/iovisor/bcc,9216aad,Jerome Marchand,2025-05-17T23:12:30Z,"tools/biosnoop: Fix biosnoop pattern option (#5304)  The code to support the block_io tracepoints failed to update some code that is used with the -P option. That code changed the second argument of __trace_req_completion from 'req' to 'key', but in the ""#ifdef INCLUDE_PATTERN"" block, the use of 'req' remained unchanged. Of course, 'key' should be use here too.  Also remove the commented out line of code related to rq_disk.  It fixes the following error: $ biosnoop -P /virtual/main.c:213:24: error: use of undeclared identifier 'req'   213 |         data.pattern = req->__sector == *sector ? SEQUENTIAL : RANDOM;       |                        ^ /virtual/main.c:216:19: error: use of undeclared identifier 'req'   216 |     last_sector = req->__sector + data.len / 512;       |                   ^ 2 errors generated. Traceback (most recent call last):   File ""/usr/share/bcc/tools/biosnoop"", line 335, in <module>     b = BPF(text=bpf_text)   File ""/usr/lib/python3.13/site-packages/bcc/__init__.py"", line 505, in __init__     raise Exception(""Failed to compile BPF module %s"" % (src_file or ""<text>"")) Exception: Failed to compile BPF module <text>  Signed-off-by: Jerome Marchand <jmarchan@redhat.com>",https://github.com/iovisor/bcc/commit/9216aad6cadd42436eac28541a9c1f5b51446a6a
iovisor/bcc,https://github.com/iovisor/bcc,af8258c,Tiezhu Yang,2025-05-17T02:50:01Z,"bcc: import subprocess in __init__.py  When executing the bcc script, there exists the following fatal error on LoongArch:  $ sudo /usr/share/bcc/tools/filetop  In file included from <built-in>:4: In file included from /virtual/include/bcc/helpers.h:54: In file included from arch/loongarch/include/asm/page.h:9: In file included from arch/loongarch/include/asm/addrspace.h:16: arch/loongarch/include/asm/loongarch.h:13:10: fatal error: 'larchintrin.h' file not found    13 | #include <larchintrin.h>       |          ^~~~~~~~~~~~~~~ 1 error generated.  git log shows that it has been fixed in the commit 8aa9f7072d53 (""Fix larchintrin.h not found error for loongarch64""), but the same error still exists in the latest mainline bcc.  This is because both clang_include_path_str and gcc_include_path_str are False due to subprocess.check_output() failed, import subprocess in __init__.py to fix it.  How to reproduce:  git clone https://github.com/iovisor/bcc.git mkdir bcc/build; cd bcc/build cmake .. make sudo make install  Fixes: 8aa9f7072d53 (""Fix larchintrin.h not found error for loongarch64"") Signed-off-by: Tiezhu Yang <yangtiezhu@loongson.cn>",https://github.com/iovisor/bcc/commit/af8258c21004f20fffb0e37aebaa0cab61253651
iovisor/bcc,https://github.com/iovisor/bcc,f2d3803,yonghong-song,2025-05-12T18:23:46Z,Use correct nickname for github publish-build-containers.yml (#5305),https://github.com/iovisor/bcc/commit/f2d3803272fcd39888b75bb508df8f095ad02411
iovisor/bcc,https://github.com/iovisor/bcc,21b0b76,yonghong-song,2025-05-12T01:46:05Z,Use ubuntu 24.04 and fedora 41 for CI testing (#5301)  The ubuntu 20.04 and fedora 38 are not supported any more. So let us upgrade to new releases for CI testing.,https://github.com/iovisor/bcc/commit/21b0b7668c2a8f7b3bedbfa3f01f87587be98b25
iovisor/bcc,https://github.com/iovisor/bcc,27dee08,Gang Yan,2025-04-17T09:54:15Z,"BCC: python: add a useful tool for mptcp  Multipath TCP (MPTCP) is an extension of the standard TCP protocol that allows a single transport connection to use multiple network interfaces or paths. MPTCP is useful for applications like bandwidth aggregation, failover, and more resilient connections.  Linux kernel starts to support MPTCP since v5.6, this patch provides a method which can easily force applications use MPTCP socket without modifing its code.  Co-developed-by: Geliang Tang <geliang@kernel.org> Signed-off-by: Geliang Tang <geliang@kernel.org> Signed-off-by: Gang Yan <yangang@kylinos.cn>",https://github.com/iovisor/bcc/commit/27dee085feaa0af7a878cd298b373c1a33c573e8
iovisor/bcc,https://github.com/iovisor/bcc,18bc672,Gang Yan,2025-04-05T05:36:10Z,"BCC: Python: Support 'fmod_ret' method for eBPF  In kernel, there exists a lot of 'fmod_ret' functions, such as 'update_socket_protocol'. But it cannot attached in BCC-python directly, so this patch provides an interface for python to use 'fmod_ret' attaching method.  This patch is suggested by Yonghong:  ''' On Sun, 2024-08-25 at 21:05 -0700, Yonghong Song wrote: ... > Gang Yan, could you explore to add fmod_ret support in bcc? It should > be similar to kfunc/kretfunc support. I am happy to review your patches. '''  And the method to check 'fmod_ret' support in kernel is from Hengqi.  Co-developed-by: Geliang Tang <geliang@kernel.org> Signed-off-by: Geliang Tang <geliang@kernel.org> Signed-off-by: Gang Yan <yangang@kylinos.cn>",https://github.com/iovisor/bcc/commit/18bc672d52a91928d1e83724c7c0d5e884c7cca2
iovisor/bcc,https://github.com/iovisor/bcc,7e6a4a4,Gang Yan,2025-04-14T03:19:35Z,"BCC: libbpf: add an interface 'kernel_enum_has_val'  Followed by the suggestions of Hengqi, which judging the kernel whether supported 'fmod_ret' by using 'kernel_struct_has_field' to check the existence of enum 'BPF_MODIFY_RETURN'.  But, the 'kernel_struct_has_filed' is not supported the 'enum' type, so this patch provides an interface 'kernel_enum_has_val' to achieve this.  Co-developed-by: Geliang Tang <geliang@kernel.org> Signed-off-by: Geliang Tang <geliang@kernel.org> Signed-off-by: Gang Yan <yangang@kylinos.cn>",https://github.com/iovisor/bcc/commit/7e6a4a4b3eb7247687a3134e99366f3912cb341c
iovisor/bcc,https://github.com/iovisor/bcc,6e76832,Feng Yang,2025-04-30T08:33:55Z,libbpf-tools: Fix the issue of unreleased resources  Fix the issue of unreleased resources  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>,https://github.com/iovisor/bcc/commit/6e7683262d53677e680ca4ae77d12f768155eff7
iovisor/bcc,https://github.com/iovisor/bcc,018ea04,Shubh Pachchigar,2025-04-27T07:30:15Z,fix typo in reference_guide.md,https://github.com/iovisor/bcc/commit/018ea04b5d7f8aa5179f270d4568f8604b681bad
iovisor/bcc,https://github.com/iovisor/bcc,5043759,Amaindex,2025-04-27T12:40:09Z,Sync with latest libbpf repo The top libbpf commit is:   4659eaafa480  sync: latest libbpf changes from kernel  Signed-off-by: Lance Yang <lance.yang@linux.dev> Signed-off-by: Amaindex <amaindex@outlook.com>,https://github.com/iovisor/bcc/commit/50437596253987298b3fc9d82675bd4c785b26aa
iovisor/bcc,https://github.com/iovisor/bcc,1dcfcec,Tanel Poder,2025-04-16T06:15:59Z,"fix typo in ""*precpu* cgroup storage""",https://github.com/iovisor/bcc/commit/1dcfcec51c89713d243247ad7abea654a6dc7b20
iovisor/bcc,https://github.com/iovisor/bcc,1f63ae6,yonghong-song,2025-04-11T15:24:06Z,"Update debian changelog for release v0.34.0 (#5277)  * Support for kernel up to 6.13   * Bump cmake minimum version to 3.12   * statsnoop: Display syscall name with -s   * readahead: Fix incorrect page accessed count since kernel 5.16   * libbpf-tools/opensnoop: Add new fields   * libbpf-tools: hardirqs/softirqs: Fix logarithmic calculation issue   * libbpf-tools/hardirqs: have better default display and add CPU column   * libbpf-tools/klockstat: Better stack dump and summary info   * libbpf-tools/sigsnoop: Support real-time signals and thread comm   * libbpf-tools/statsnoop: Support more syscalls   * libbpf-tools/memleak: Some fixes and better messages   * tools/opensnoop: Add new fields and fix bad mode value   * tools/profile: Prioritize using the cpu-cycles hardware event   * tools/tcpdrop: Add support for dumping TCP drop reasons   * Fix event name too long error in python source   * doc update, other bug fixes and example improvement.  Signed-off-by: Yonghong Song <yonghong.song@linux.dev> Co-authored-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/1f63ae6e1c34c9ca3d5dcf339abecd16651593c2
iovisor/bcc,https://github.com/iovisor/bcc,f25ee31,Rong Tao,2025-04-11T14:34:20Z,"Adapt to gcc 7.3.0 std::string.replace() (#5275)  compile bcc on gcc (GCC) 7.3.0:      $ make     ...     [  1%] Building CXX object src/cc/CMakeFiles/bpf-static.dir/common.cc.o     /home/rongtao/Git/bcc/src/cc/common.cc: In function ‘ebpf::field_kind_t ebpf::_get_field_kind(const string&, std::__cxx11::string&, std::__cxx11::string&, int*)’:     /home/rongtao/Git/bcc/src/cc/common.cc:178:59: error: no matching function for call to ‘std::__cxx11::basic_string<char>::replace(long unsigned int, long unsigned int, std::__cxx11::basic_string<char>&, int)’            field_name.replace(pos1 + 1, pos2 - pos1 - 1, dim, 0);                                                                ^     In file included from /usr/include/c++/7.3.0/string:52:0,                      from /usr/include/c++/7.3.0/bits/locale_classes.h:40,                      from /usr/include/c++/7.3.0/bits/ios_base.h:41,                      from /usr/include/c++/7.3.0/ios:42,                      from /usr/include/c++/7.3.0/istream:38,                      from /usr/include/c++/7.3.0/fstream:38,                      from /home/rongtao/Git/bcc/src/cc/common.cc:16:     /usr/include/c++/7.3.0/bits/basic_string.h:1861:7: note: candidate: std::__cxx11::basic_string<_CharT, _Traits, _Alloc>& std::__cxx11::basic_string<_CharT, _Traits, _Alloc>::replace(std::__cxx11::basic_string<_CharT, _Traits, _Alloc>::size_type, std::__cxx11::basic_string<_CharT, _Traits, _Alloc>::size_type, const std::__cxx11::basic_string<_CharT, _Traits, _Alloc>&) [with _CharT = char; _Traits = std::char_traits<char>; _Alloc = std::allocator<char>; std::__cxx11::basic_string<_CharT, _Traits, _Alloc>::size_type = long unsigned int]            replace(size_type __pos, size_type __n, const basic_string& __str)            ^~~~~~~  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/f25ee31b6a74b11fc51304560f55ae2241a29474
iovisor/bcc,https://github.com/iovisor/bcc,c6eb562,yonghong-song,2025-04-11T14:20:17Z,"Fix llvm compilation failure (#5276)  Upstream patch [1] caused bcc build failure:   ...   /home/yhs/work/bcc/src/cc/bcc_debug.cc: In member function ‘void ebpf::SourceDebugger::dump()’:   /home/yhs/work/bcc/src/cc/bcc_debug.cc:117:43: error: no matching function for call to       ‘std::__cxx11::basic_string<char>::basic_str’     117 |   string TripleStr(mod_->getTargetTriple());         |                                           ^   ...   /home/yhs/work/bcc/src/cc/bpf_module.cc: In member function ‘int ebpf::BPFModule::finalize()’:   /home/yhs/work/bcc/src/cc/bpf_module.cc:546:24: error: cannot convert ‘const char [13]’ to ‘llvm::Triple’     546 |   mod->setTargetTriple(""bpf-pc-linux"");         |                        ^~~~~~~~~~~~~~         |                        |         |                        const char [13]   ...  This patch fixed the above compilation failure.    [1] https://github.com/llvm/llvm-project/pull/129868",https://github.com/iovisor/bcc/commit/c6eb562f47c030ddcf319df2bf45e28e7ec95967
iovisor/bcc,https://github.com/iovisor/bcc,dd08f0f,Feng Yang,2025-04-11T04:03:26Z,"hardirqs: Optimize output information and increase CPU display (#5228)  Combine the previous count and time into one, and increase CPU independent statistics and maximum interrupt time  Before: ./hardirqs Tracing hard irq event time... Hit Ctrl-C to end. ^C HARDIRQ                    TOTAL_usecs enp0s3                             254 snd_intel8x0                       368  ./hardirqs -C Tracing hard irq events... Hit Ctrl-C to end. ^C HARDIRQ                    TOTAL_count enp0s3                              14 ata_piix                             2  After: ./hardirqs Tracing hard irq event time... Hit Ctrl-C to end. ^C HARDIRQ                   TOTAL_count TOTAL_usecs MAX_usecs ata_piix                            2          32        21 enp0s3                             19         318        42  ./hardirqs -C Tracing hard irq event time... Hit Ctrl-C to end. ^C HARDIRQ                   TOTAL_count TOTAL_usecs MAX_usecs CPU enp0s3                         111375     1420732       303   2 enp0s3                           1546       21826        39   9 ata_piix                            8         162        33   8  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/dd08f0ff062407cbf0cad334f516905a50b9561b
iovisor/bcc,https://github.com/iovisor/bcc,d124144,Rong Tao,2025-04-11T03:48:28Z,"libbpf-tools: llcstat: Fix error: redefinition of 'key_info' on aarch64 (#5265)  Rename key_info to llcsta_key_info, at the same time, in order to ensure the consistency of key-value naming, rename value_info to llvstat_value_info.      $ make     ...       BPF      llcstat.bpf.o     In file included from llcstat.bpf.c:7:     ./llcstat.h:13:8: error: redefinition of 'key_info'        13 | struct key_info {           |        ^     arm64/vmlinux.h:140310:8: note: previous definition is here      140310 | struct key_info {             |        ^     llcstat.bpf.c:27:6: error: no member named 'cpu' in 'struct key_info'        27 |         key.cpu = bpf_get_smp_processor_id();           |         ~~~ ^     llcstat.bpf.c:28:6: error: no member named 'pid' in 'struct key_info'        28 |         key.pid = pid_tgid >> 32;           |         ~~~ ^     llcstat.bpf.c:30:7: error: no member named 'tid' in 'struct key_info'        30 |                 key.tid = (u32)pid_tgid;           |                 ~~~ ^     llcstat.bpf.c:32:7: error: no member named 'tid' in 'struct key_info'        32 |                 key.tid = key.pid;           |                 ~~~ ^     llcstat.bpf.c:32:17: error: no member named 'pid' in 'struct key_info'        32 |                 key.tid = key.pid;           |                           ~~~ ^     6 errors generated.     make: *** [Makefile:207: /home/rongtao/Git/bcc/libbpf-tools/.output/llcstat.bpf.o] Error 1  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/d124144e7f9c16972f04a97fbdca4ebe98a657f8
iovisor/bcc,https://github.com/iovisor/bcc,97eaeca,Feng Yang,2025-04-11T03:43:34Z,"Fix event name too long error in python source (#5271)  When the event name is too long, such as p:uprobes/p__proc_124566_root_usr_lib64_libruby_so_3_2_2_0xda3ac_124566_bcc_131967, an error will occur when executing the write function of function create_probe_event.  The kernel error path is probes_write   trace_parse_run_command     create_or_delete_trace_uprobe       trace_uprobe_create         trace_probe_create           __trace_uprobe_create             traceprobe_parse_event_name 		else if (len >= MAX_EVENT_NAME_LEN) Requires less than 64 bytes. Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/97eaeca75b7b906a95be306689032b9bb6064ffc
iovisor/bcc,https://github.com/iovisor/bcc,6ea2a0e,Rong Tao,2025-04-11T03:33:05Z,"libbpf-tools: sigsnoop: display target process's comm (#5272)  Directly print the comm of the target process to display information more intuitively, without having to use commands such as 'ps' to query the comm information of the pid process again.      $ sudo ./sigsnoop -n     TIME     PID     COMM             SIG          TPID    TCOMM            RESULT     11:29:06 1128124 vte-urlencode-c  SIGCHLD      1127674 bash             0     11:29:08 1128126 ls               SIGCHLD      1127674 bash             0     11:29:08 1128127 vte-urlencode-c  SIGCHLD      1127674 bash             0     11:29:08 1881    Xorg             SIGALRM      1881    Xorg             0     11:29:11 0       swapper/3        SIGNAL-34    2545    sssd_kcm         0     11:29:21 1127194 kworker/u48:6    SIGINT       1127674 bash             0     11:29:21 1127674 bash             SIGINT       1127674 bash             0     11:29:21 1128130 vte-urlencode-c  SIGCHLD      1127674 bash             0     11:29:21 1881    Xorg             SIGALRM      1881    Xorg             0     11:29:21 0       swapper/1        SIGNAL-34    2545    sssd_kcm         0                                                            ^^^^^^^^^^^^^^^^  If current kernel is unsupport bpf_task_from_pid(), linux < v6.1 [1], the TCOMM field displays 'N/A':      $ sudo ./sigsnoop -n     WARNING: Current kernel not support bpf_task_from_pid(), ignore TCOMM field     TIME     PID     COMM             SIG          TPID    TCOMM            RESULT     15:01:24 289689  pmsleep          SIGCHLD      289348  N/A              0     15:01:24 289691  expr             SIGCHLD      289348  N/A              0     15:01:25 289693  pmprobe          SIGCHLD      289692  N/A              0     15:01:25 289694  gawk             SIGCHLD      289692  N/A              0     15:01:25 289692  pmlogger_check   SIGCHLD      289348  N/A              0     15:01:25 289695  pmsleep          SIGCHLD      289348  N/A              0     15:01:25 289696  expr             SIGCHLD      289348  N/A              0                                                            ^^^^^^^^^^^^^^^^  Link: https://github.com/torvalds/linux/commit/3f0e6f2b41d3 [1]  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/6ea2a0efa5262cfc931418206fcab92d58573b76
iovisor/bcc,https://github.com/iovisor/bcc,2940304,Eunseon Lee,2025-04-07T06:45:56Z,libbpf-tools/drsnoop: Fix typo,https://github.com/iovisor/bcc/commit/29403046f7a5d86600bced4962c1ecfd994b7f87
iovisor/bcc,https://github.com/iovisor/bcc,322dfef,Rong Tao,2025-04-03T18:57:56Z,"libbpf-tools: syscall_helpers.c: Fix incorrect syscall name (#5264)  In [1] commit dc24158af21e (""libbpf-tools: syscount: Add syscall lookup table for arm64 and riscv""), an incorrect system call name was introduced, probably because __NR_syscalls was used directly to obtain the name ""syscalls"", while in fact it was a count.  Link: https://github.com/iovisor/bcc/commit/dc24158af21e [1]  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/322dfefaaa267e4c51f7d75fb0e4de10a255bb8e
iovisor/bcc,https://github.com/iovisor/bcc,e5d31ac,Ism Hong,2025-04-03T18:54:38Z,"tools/readahead: Fix incorrect page accessed count since v5.16 (#5266)  Since Linux v5.16 commit 76580b65(""mm/swap: Add folio_mark_accessed()"") [1], filemap_read() no longer calls mark_page_accessed() but instead uses folio_mark_accessed(). This change caused the readahead tool to miss tracking accessed pages, resulting in incorrect statistics.  This patch fixes the issue by detecting whether folio_mark_accessed() or mark_page_accessed() is available in the kernel and probing the appropriate function to correctly count page accesses. The implementation maintains compatibility with both pre-v5.16 and post-v5.16 kernels.  Verified with v5.15.60 (Arch Linux) and v6.8.0 (Ubuntu 2404).  [1]: https://github.com/torvalds/linux/commit/76580b65  Signed-off-by: Ism Hong <ism.hong@gmail.com>",https://github.com/iovisor/bcc/commit/e5d31ac1cfff8083fbf7d1e3d8ae15346dba75a5
iovisor/bcc,https://github.com/iovisor/bcc,1706b2a,yu410621,2025-04-01T05:53:51Z,"tools/sofdsnoop: Add argument ""--ebpf"" (#5262)  Add argument ""--ebpf"" for tools/sofdsnoop.  Signed-off-by: yu410621 <lihuanyu410621@gmail.com>",https://github.com/iovisor/bcc/commit/1706b2a1b4c752c0a82beba31d9defd1665675d9
iovisor/bcc,https://github.com/iovisor/bcc,7de969a,Rong Tao,2025-04-01T05:35:52Z,"libbpf-tools: syscall_helpers.c: support loongarch64 and add more generic syscall (#5263)  Display syscall name on loongarch64, instead of fallback to '[unknown: %u]'.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/7de969a8e985bb9d218d7e781ade857b58ecb98e
iovisor/bcc,https://github.com/iovisor/bcc,24a1033,b106roger,2025-04-01T05:04:36Z,"libbpf-tools/readahead: Fix low page usage count since v5.15 (#5257)  Since Linux 5.15, `mark_page_accessed` is no longer called in `filemap_read`, which causes increased counts of unused page cache.  This patch attempts to attach `mark_accessed` to `folio_mark_accessed` if it is available; otherwise, it falls back to using `mark_page_accessed`.  Signed-off-by: B106Roger <imbigking12@gmail.com> Co-authored-by: roger_weijie <roger_weijie@realtek.com>",https://github.com/iovisor/bcc/commit/24a1033f2126539d0c3369cb51ed31198dc3be89
iovisor/bcc,https://github.com/iovisor/bcc,b139a18,Rong Tao,2025-03-25T08:34:54Z,libbpf-tools: statsnoop: Missing dirfd check  Forgot check dirfd in [1].  Link: https://github.com/iovisor/bcc/commit/55f5bd3ac43fe47f51b0b98ea0dbcb142e3b788e [1] Signed-off-by: Rong Tao <rongtao@cestc.cn>,https://github.com/iovisor/bcc/commit/b139a18f56331899a83c13d92daf35339c4a836c
iovisor/bcc,https://github.com/iovisor/bcc,82ad428,Hengqi Chen,2025-03-27T14:18:08Z,libbpf-tools: Adapt runqlen for struct field renaming  The v6.14 development cycle renamed cfs_rq::nr_running to cfs_rq::nr_queued. This breaks runqlen tool. Fix it. Closes: #5254.  Signed-off-by: Hengqi Chen <hengqi.chen@gmail.com>,https://github.com/iovisor/bcc/commit/82ad428c40cb270fda6c0de5a9914705c94dd4c7
iovisor/bcc,https://github.com/iovisor/bcc,bdffe00,Hengqi Chen,2025-03-27T14:18:48Z,libbpf-tools: Update vmlinux.h for all supported arch  The vmlinux.h is generated from v6.14 kernel built with each arch's defconfig and the following configs:     CONFIG_BPF_SYSCALL=y     CONFIG_DEBUG_INFO=y     CONFIG_DEBUG_INFO_BTF=y     CONFIG_DEBUG_INFO_DWARF4=y     CONFIG_FTRACE=y     CONFIG_FTRACE_SYSCALLS=y     CONFIG_HAVE_SYSCALL_TRACEPOINTS=y     CONFIG_TRACEPOINTS=y  Signed-off-by: Hengqi Chen <hengqi.chen@gmail.com>,https://github.com/iovisor/bcc/commit/bdffe002b1367756f9b69c58acc1e811cd8f76f8
iovisor/bcc,https://github.com/iovisor/bcc,45959a4,Hengqi Chen,2025-03-27T14:19:26Z,bcc: Sync with latest libbpf repo  Signed-off-by: Hengqi Chen <hengqi.chen@gmail.com>,https://github.com/iovisor/bcc/commit/45959a468e211b7b14b476dc4dda3dc3e59e7b9f
iovisor/bcc,https://github.com/iovisor/bcc,079a61b,yu410621,2025-03-29T20:54:07Z,libbpf-tools/tcptracer: Remove unused parameter 'ctx' (#5253)  The `ctx` parameter is unused in both `enter_tcp_connect()` and `exit_tcp_connect()`. Consider removing it to clean up the code.  Signed-off-by: yu410621 <lihuanyu410621@gmail.com>,https://github.com/iovisor/bcc/commit/079a61ba6542168a8a7bf668bc5253a7d269949e
iovisor/bcc,https://github.com/iovisor/bcc,88d6219,Lance Yang,2025-03-23T12:14:16Z,"tcpdrop: add support for dumping TCP drop reasons  This commit adds support for dumping TCP drop reasons. It maps these reasons to human-readable strings, making it easier to understand why TCP packets are dropped. In cases where the drop reason is not supported, 'NOT_SPECIFIED' will be displayed.  Signed-off-by: Mingzhe Yang <mingzhe.yang@ly.com> Signed-off-by: Lance Yang <lance.yang@linux.dev>",https://github.com/iovisor/bcc/commit/88d6219546554738b6f22b14d8a4fce15574052f
iovisor/bcc,https://github.com/iovisor/bcc,265f4dd,Toke Høiland-Jørgensen,2025-03-26T07:57:42Z,"klockstat: Don't crash on NULL ksym when looping over stack  The ksym returned by ksyms__map_addr() can be 0, in which case we will crash in the loop in find_stack_offset(). Fix this by skipping NULL ksyms in the loop.  Fixes: f449d05ba315 (""libbpf-tools/klockstat: Search for correct stack offset in userspace (#5203)"") Signed-off-by: Toke Høiland-Jørgensen <toke@toke.dk>",https://github.com/iovisor/bcc/commit/265f4dd081b6577b1b3828e6367fd18339aac768
iovisor/bcc,https://github.com/iovisor/bcc,f9ed579,Toke Høiland-Jørgensen,2025-03-25T12:42:58Z,"klockstat: Track IOCTL numbers  Similar to the support for tracking netlink message types, add tracking of IOCTL numbers to klockstat, by adding a probe to sock_do_ioctl(). Since the IOCTL numbers are not defined as an enum, they are not in kernel BTF, so use a static list of IOCTL numbers generated from the sockios.h kernel UAPI header.  This gives output like the following:                                 Caller  Avg Wait    Count   Max Wait   Total Wait                      dev_ethtool+0xad    673 ns        4     2.3 us       2.7 us                       dev_ioctl+0x309                    sock_do_ioctl+0xea bpf_prog_6deef7357e7b4530_sd_fw_ingress                     sock_do_ioctl+0x5                               Max PID 1278, COMM systemd-network, Lock rtnl_mutex (0xffffffffa7622b60) ioctl SIOCETHTOOL  Signed-off-by: Toke Høiland-Jørgensen <toke@toke.dk>",https://github.com/iovisor/bcc/commit/f9ed579ec59e15cb4261f7e3d2840570b78d3aba
iovisor/bcc,https://github.com/iovisor/bcc,3d22502,Lance Yang,2025-03-23T06:01:44Z,"tcpdrop: fix unexpected exit if tcp_drop() missing  This commit fixes an issue where tcpdrop would unexpectedly exit when the tcp_drop() function is not found, even if the 'skb:kfree_skb' tracepoint is traceable. Now, tcpdrop will continue running with a warning message in that case.  Fixes: b93c0a9 (""tcp_drop() not findable is an error."") Signed-off-by: Mingzhe Yang <mingzhe.yang@ly.com> Signed-off-by: Lance Yang <lance.yang@linux.dev>",https://github.com/iovisor/bcc/commit/3d225025387b4945c2672f2a346a911e34b3de10
iovisor/bcc,https://github.com/iovisor/bcc,84551e7,Ism Hong,2025-03-21T17:38:41Z,"tools/criticalstat: Update error message with kernel version-specific config requirements (#5246)  The kernel configurations required for preempt/irq tracepoints changed in Linux 4.19 due to commit c3bc8fd637a9 (""tracing: Centralize preemptirq tracepoints and unify their usage""). This patch updates the error messages and documentation to clearly specify which kernel configurations should be enabled based on kernel version:  - For kernel 4.19 and later:   CONFIG_PREEMPTIRQ_TRACEPOINTS, CONFIG_TRACE_IRQFLAGS, CONFIG_TRACE_PREEMPT_TOGGLE  - For kernel 4.15 to 4.18:   CONFIG_PREEMPTIRQ_EVENTS, CONFIG_PROVE_LOCKING  Common requirements for all versions: - CONFIG_DEBUG_PREEMPT - CONFIG_PREEMPT_TRACER  Additionally, CONFIG_LOCKDEP should be disabled on older kernels.  These changes make it easier for users to identify and enable the correct configuration options for their specific kernel version.  Link: https://git.kernel.org/pub/scm/linux/kernel/git/torvalds/linux.git/commit/?id=c3bc8fd637a9  Signed-off-by: Ism Hong <ism.hong@gmail.com>",https://github.com/iovisor/bcc/commit/84551e7b1f5e49150aa12e4edc9830ba5e96a3e2
iovisor/bcc,https://github.com/iovisor/bcc,1608db9,ekyooo,2025-03-21T17:21:20Z,"libbpf-tools/memleak: Change the start message to match memleak python (#5248)  Change the start message to match memleak python, make it concise, and include the PID.  Before:   # ./memleak     using default object: libc.so.6     using page size: 4096     tracing kernel: true     Tracing outstanding memory allocs...  Hit Ctrl-C to end    # ./memleak -p `pidof alloctest`     using default object: libc.so.6     using page size: 4096     tracing kernel: false     Tracing outstanding memory allocs...  Hit Ctrl-C to end  After:   # ./memleak     using default object: libc.so.6     using page size: 4096     Attaching to kernel allocators, Ctrl+C to quit.    # ./memleak -p `pidof alloctest`     using default object: libc.so.6     using page size: 4096     Attaching to pid 29973, Ctrl+C to quit.",https://github.com/iovisor/bcc/commit/1608db90e951ab115bb4bcb201ad87dc616679e3
iovisor/bcc,https://github.com/iovisor/bcc,6c25f9a,ekyooo,2025-03-21T17:15:21Z,libbpf-tools/memleak: Allocate map and calculate statistics only when -C option is used (#5240)  Allocate map and calculate statistics only when the -C(--combined-only) option is used,https://github.com/iovisor/bcc/commit/6c25f9ac7ac0ec5c5494a7ab193685fa12975a0c
iovisor/bcc,https://github.com/iovisor/bcc,c58d7b4,ekyooo,2025-03-21T17:05:37Z,"libbpf-tools/memleak: Fix output error for invalid stackid when using combined-only mode (#5238)  Issue: In combined-only mode, when obtaining the stack ID in the BPF program, the returned error values are also counted and included in the outstanding allocation list in the user program. This can convey inaccurate information to the user, so fixed.  Before:   $ ./memleak --stack-storage-size 3 -C     Tracing outstanding memory allocs...  Hit Ctrl-C to end     [17:10:33] Top 2 stacks with outstanding allocations:     50456128 bytes in 13270 allocations from stack     31971040 bytes in 5056 allocations from stack     ^C[17:10:35] Top 2 stacks with outstanding allocations:     51514048 bytes in 13538 allocations from stack     31992664 bytes in 5123 allocations from stack     done    When adding logs (// indicates logs added for testing):   $ ./memleak --stack-storage-size 3 -C     Tracing outstanding memory allocs...  Hit Ctrl-C to end     // alloc.stack_id: -17, alloc.count: 236     // alloc.stack_id: -12, alloc.count: 5492     [17:18:15] Top 2 stacks with outstanding allocations:     22481736 bytes in 5492 allocations from stack // <-- The count of -17 (EEXIST)     61040 bytes in 236 allocations from stack  After:   $ ./memleak --stack-storage-size 3 -C     Tracing outstanding memory allocs...  Hit Ctrl-C to end     // [filterout] alloc.stack_id: -12, alloc.count: 5742     // alloc.stack_id: 3, alloc.count: 5     [17:22:31] Top 1 stacks with outstanding allocations:     480 bytes in 5 allocations from stack       0 [<ffffffffbbc5eb0d>] __kmalloc+0x28d       1 [<ffffffffbbc5eb0d>] __kmalloc+0x28d       2 [<ffffffffbbb0b6b7>] bpf_prog_array_copy+0x177       3 [<ffffffffbbaebee2>] perf_event_attach_bpf_prog+0xf2       4 [<ffffffffbbba6b8c>] perf_event_set_bpf_prog+0x18c  Add a feature to check for stack trace map shortage issues and recommend increasing the stack trace map size if such issues occur.  Usage examples:   $ ./memleak --stack-storage-size 1     Tracing outstanding memory allocs...  Hit Ctrl-C to end     [12:22:50] Top 1 stacks with outstanding allocations:     320 bytes in 5 allocations from stack       0 [<ffffffffbbc5eb0d>] __kmalloc+0x28d       1 [<ffffffffbbc5eb0d>] __kmalloc+0x28d       ...       15 [<ffffffffbca28fdf>] do_syscall_64+0x7f       16 [<ffffffffbcc00130>] entry_SYSCALL_64_after_hwframe+0x78     WARNING: 5967 stack traces could not be displayed due to memory shortage, including 441 caused by hash collisions. Consider increasing --stack-storage-size.     done    $ ./memleak --stack-storage-size 1 -C     Tracing outstanding memory allocs...  Hit Ctrl-C to end     [12:23:32] Top 0 stacks with outstanding allocations:     WARNING: 7093 stack traces could not be displayed due to memory shortage, including 508 caused by hash collisions. Consider increasing --stack-storage-size.     done",https://github.com/iovisor/bcc/commit/c58d7b43fa49381f8903ad7b192be8f2e7172474
iovisor/bcc,https://github.com/iovisor/bcc,e237c86,Adrián López,2025-03-21T16:50:05Z,tools/sofdsnoop: implement custom min to avoid non-static (#5247)  BPF compiler fails to compile `min` with error: cannot call non-static helper function,https://github.com/iovisor/bcc/commit/e237c866fd2da74df69f57a543e783b85f57c993
iovisor/bcc,https://github.com/iovisor/bcc,60601f6,kiraskyler,2025-03-21T02:55:20Z,"libbpf-tools:Fix biosnoop dependency on kernel version (#5244)  tracepoint block_rq_insert and block_rq_issue changed from 5.10.137, not 5.11  Signed-off-by: niuwanli <niuwanli@cqsoftware.com.cn>",https://github.com/iovisor/bcc/commit/60601f689baf8723a216c950b32a29451d58d181
iovisor/bcc,https://github.com/iovisor/bcc,dd14376,Shung-Hsi Yu,2025-03-21T02:48:38Z,"Bump CMake minimum version to 3.12 (#5245)  With CMake 4 the minimum support version is 3.5, and since the current minimum version we set is 2.8.12, it will fail with the following message:    CMake Error at CMakeLists.txt:3 (cmake_minimum_required):     Compatibility with CMake < 3.5 has been removed from CMake.      Update the VERSION argument <min> value.  Or, use the <min>...<max> syntax     to tell CMake that the project requires at least <min> but has been updated     to work with policies introduced by <max> or earlier.      Or, add -DCMAKE_POLICY_VERSION_MINIMUM=3.5 to try configuring anyway.  However, instead of bumping the minimum version requirement to 3.5, bump to a slightly higher 3.12 instead to be consistent with examples/usdt_sample/.  Also update cmake_policy() calls due to this change, dropping CMP0057 since the OLD behavior is no longer supported anyway.",https://github.com/iovisor/bcc/commit/dd1437669ddd2938e742a73c53d0c4af6357cf61
iovisor/bcc,https://github.com/iovisor/bcc,a2da647,Adrián López,2025-03-21T02:31:03Z,tools/sslsniff: implement custom min to avoid non-static (#5242)  BPF compiler fails to compile `min` with error: cannot call non-static helper function  Fix #5241,https://github.com/iovisor/bcc/commit/a2da6474fa4e7cc7628087c8afd5f8ff9be5bdb1
iovisor/bcc,https://github.com/iovisor/bcc,477ed04,ekyooo,2025-03-20T21:17:21Z,libbpf-tools/memleak: Add options to adjust stack map size (#5237)  Add --stack-storage-size and --perf-max-stack-depth options,https://github.com/iovisor/bcc/commit/477ed040416d384fff6fb33c9ce72087b9e0bd81
iovisor/bcc,https://github.com/iovisor/bcc,b78b492,kiraskyler,2025-03-20T21:08:43Z,"libbpf-tools:Fix bitesize dependency on kernel version (#5234)  tracepoint block_rq_issue changed from 5.10.137, not 5.11  Signed-off-by: niuwanli <niuwanli@cqsoftware.com.cn>",https://github.com/iovisor/bcc/commit/b78b4927574be6265a7f1db9c081b1a3e053ff2c
iovisor/bcc,https://github.com/iovisor/bcc,55f5bd3,Rong Tao,2025-03-20T20:54:20Z,"libbpf-tools: statsnoop: Support fstat(2) and parse fd/dirfd in userspace (#5233)  Added support for fstat system calls, and resolve file names and paths from fd and dirfd in user mode.  Userspace test code:      # fstatat.c     dirfd = openat(AT_FDCWD, ""./"", O_RDONLY | O_CLOEXEC);     fstatat(dirfd, argv[0], &buf, AT_SYMLINK_NOFOLLOW);     fstatat(dirfd, ""/etc/os-release"", &buf, AT_SYMLINK_NOFOLLOW);      # fstat.c     fd = open(""/etc/os-release"", O_RDONLY);     fstat(fd, &buf);     fstat(AT_FDCWD, &buf);  Tracing:    Before:      $ sudo ./statsnoop -s     PID     COMM                 RET  ERR  SYSCALL    PATH     25719   fstatat              0    0    newfstatat ./fstatat        <no cwd>     25719   fstatat              0    0    newfstatat /etc/os-release     < couldn't tracing fstat(2) >    This patch:      $ sudo ./statsnoop -s     PID     COMM                 RET  ERR  SYSCALL    PATH     26794   fstatat              0    0    newfstatat /home/sdb/Git/tst-linux/syscall/samples/stat/./fstatat     26794   fstatat              0    0    newfstatat /etc/os-release     26797   fstat                0    0    newfstat   /usr/lib/os-release     26800   fstat                -1   9    newfstat   /home/sdb/Git/tst-linux/syscall/samples/stat  Maybe this isn't a good approach, as it's possible that both the process and the fd don't exist during parsing the fd and dirfd. Of course, this is problematic for processes and fds that survive for a short period of time, however, for long-running daemons, there is no problem.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/55f5bd3ac43fe47f51b0b98ea0dbcb142e3b788e
iovisor/bcc,https://github.com/iovisor/bcc,db5b63f,Toke Høiland-Jørgensen,2025-03-15T04:08:50Z,"libbpf-tools/klockstat: Track netlink message types when taking locks (#5230)  The klockstat tool is useful to debug stalls on kernel locks, but when tracking the RTNL lock, a lot of the stack traces will just show rtnetlink_rcv_msg() or netlink_dump() as the callers that take the lock. It is not possible to tell from the stack trace which netlink command is being executed that caused the lock to be taken, which makes it harder to debug.  To help with this, add probes to those two netlink functions that capture the nlmsg_type and store it in a hashmap keyed on the current tid. When accounting a lock operation, store the nlmsg type along with the max_comm.  On the userspace side, print the message type if it is set. Parse the vmlinux BTF to turn the values into the constants names for better readability. This gives output like the following:                                 Caller  Avg Wait    Count   Max Wait   Total Wait                      rtnl_dumpit+0x74    1.7 us        1     1.7 us       1.7 us                    netlink_dump+0x138            __netlink_dump_start+0x1eb               rtnetlink_rcv_msg+0x2ae                  netlink_rcv_skb+0x50                               Max PID 1124, COMM bird, Lock rtnl_mutex (0xffffffff9e422b60) nltype RTM_GETLINK  Since the type is only printed along with a stack dump, the new probes are only enabled when -s is set to a value larger than 1.  Signed-off-by: Toke Høiland-Jørgensen <toke@toke.dk>",https://github.com/iovisor/bcc/commit/db5b63ff876d3346021871e2189a354bfc6d510e
iovisor/bcc,https://github.com/iovisor/bcc,e706277,Rong Tao,2025-03-14T17:52:29Z,tools/statsnoop: Add -s to display syscall name (#5227)  Do the same thing that [1] did.      $ sudo ./statsnoop.py -t -s     TIME(s)       PID     COMM               FD ERR SYSCALL      PATH     0.000000000   9761    lstat               0   0 newfstatat   /etc/os-release     0.000269740   9761    lstat               0   0 newlstat     /etc/os-release     1.871977757   2555    pool                0   0 newfstatat   /etc/krb5.conf     3.135518800   2931    terminator         -1   2 newfstatat   /home/rongtao/.local/share/icons/Adwaita     3.135549915   2931    terminator         -1   2 newfstatat   /home/rongtao/.icons/Adwaita  Link: https://github.com/iovisor/bcc/commit/82f9d1cb633a [1]  Signed-off-by: Rong Tao <rongtao@cestc.cn>,https://github.com/iovisor/bcc/commit/e70627709cd71394ac0f4b0fbe2fe2c94ece1c9d
iovisor/bcc,https://github.com/iovisor/bcc,82f9d1c,Rong Tao,2025-03-08T07:26:00Z,"libbpf-tools/statsnoop: Display syscall name with -s  Display the system call name is more helpful for analysis, like:      $ sudo ./statsnoop -s     PID     COMM                 RET  ERR  SYSCALL    PATH     83459   code                 -1   2    statx      /home/rongtao/.config/Code/User/tasks.json     2807    terminator           0    0    newfstatat /usr/share/icons     2807    terminator           -1   2    newfstatat /home/rongtao/.local/share/flatpak/exports/share/pixmaps     2807    terminator           -1   2    newfstatat /usr/local/share/pixmaps     2807    terminator           0    0    newfstatat /usr/share/pixmaps     83445   code                 -1   2    statx      /home/sdb/Git/5.10.13/.vscode/c_cpp_properties.json     2525    pool                 0    0    newfstatat /etc/krb5.conf     88285   ls                   0    0    statfs     /sys/fs/selinux     88285   ls                   0    0    statx      listdir.c  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/82f9d1cb633aa3b4ebcbbc5d8b809f48d3dfa222
iovisor/bcc,https://github.com/iovisor/bcc,92e32ff,Wei,2025-03-03T17:34:34Z,"examples/tracing/bitehist.py: Fix kprobe attaching failure (#5223)  Fix the same issue as the commit cccb26e3d69f0b263562c581add517ed23e1834b fixed for disksnoop.py previously.  blk_account_io_done became inline function since kernel v5.16 and blk_account_io_done has been taken off since v6.4. With this change, only when the code runs on a legacy kernel these *_io_done functions will be attached, otherwise it goes for blk_mq_end_request.  The tutorial lessons for both bitehist.py and disksnoop.py are updated accordingly.  Signed-off-by: Wei <wei@hardenedlinux.org>",https://github.com/iovisor/bcc/commit/92e32ff8a06616779f3a3191b75da6881d59fd17
iovisor/bcc,https://github.com/iovisor/bcc,62178b9,Rong Tao,2025-03-03T17:33:36Z,"libbpf-tools: signoop: Support real-time signals (#5216)  In the POSIX standard, real-time signals range from SIGRTMIN to SIGRTMAX. Real-time signals differ from standard signals in that they can be queued and each signal can carry additional information.  Link: https://github.com/iovisor/bcc/pull/5216 [1] Reviewed-by: Hengqi Chen <hengqi.chen@gmail.com> Reviewed-by: Yonghong Song <yonghong.song@linux.dev> Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/62178b93ae5bb1303ea1fa385fd99fe2cb08c95a
iovisor/bcc,https://github.com/iovisor/bcc,b93c0a9,David Grant,2025-03-01T01:40:43Z,tcp_drop() not findable is an error.,https://github.com/iovisor/bcc/commit/b93c0a9e2d91fb1bbe34c26c932051307c03faa6
iovisor/bcc,https://github.com/iovisor/bcc,f449d05,Toke Høiland-Jørgensen,2025-02-27T22:20:36Z,"libbpf-tools/klockstat: Search for correct stack offset in userspace (#5203)  The klockstat BPF code contains a hard-coded offset (of 4) for the captured stack entries, which is supposed to get rid of the topmost entries that are just locking functions. However, when running the klockstat tool on RHEL, this offset is not correct, leading to output like the following:                                 Caller  Avg Wait    Count   Max Wait   Total Wait                        mutex_lock+0x5    1.1 us        3     1.8 us       3.2 us                        mutex_lock+0x5    825 ns        5     1.6 us       4.1 us                        mutex_lock+0x5    1.1 us        4     1.5 us       4.3 us                                 Caller  Avg Hold    Count   Max Hold   Total Hold                        mutex_lock+0x5   18.0 ms        3    23.0 ms      54.0 ms                        mutex_lock+0x5    1.7 ms       15     2.2 ms      25.1 ms                        mutex_lock+0x5    1.7 ms       15     2.2 ms      25.1 ms  To fix this, remove the offset in the BPF code and add logic in the userspace component to walk the stack frames and find the right offset. We do this by keeping a list of all the possible lock function names we attach to, pre-resolving them into kernel symbol addresses. Then, each time we process a stack trace obtained from the kernel, we walk the stack until we find one of those symbols, and use that (+1) as the stack offset to process.  This makes the output work correctly regardless of the offset of the stack offset on a given system.  Signed-off-by: Toke Høiland-Jørgensen <toke@toke.dk>",https://github.com/iovisor/bcc/commit/f449d05ba3150cf4809c86ee841d8678198ec849
iovisor/bcc,https://github.com/iovisor/bcc,2b32635,rockyxing,2025-02-21T04:51:00Z,"tools/profile: Prioritize using the cpu-cycles hardware event (#5214)  We know that tools/profile acts likely perf-record, and both use perf_events sampling.  Refer to perf record implementation (source code link & screenshot at below), we prioritize the cpu-cycles hardware event by default, which provides higher precision and lower overhead compared to software events. If the cpu-cycles hardware event not supported (e.g., in a virtual machine environment), we fall back to cpu-clock software event.  https://elixir.bootlin.com/linux/v6.6/source/tools/perf/util/evsel.c#L2836  In addition, refer to runqlen.py, redirect stderr to devnull before attaching the cpu-cycles hardware event, which will avoid printing ""perf_event_open failed: No such file or directory"" on the screen.",https://github.com/iovisor/bcc/commit/2b32635a4f33ba307761a7c39f6e0bfd19b019b4
iovisor/bcc,https://github.com/iovisor/bcc,43e0c33,Wei,2025-02-21T04:34:27Z,"New examples/tracing/setuid_monitor.py: Fix #5211 (#5215)  Add new examples/tracing/setuid_monitor.py as a demonstration of the usage of TRACEPOINT_PROBE, for examples/tracing/urandomread.py does not work since kernel 5.18 in which tracepoint/random/urandom_read has been removed.  The tutorial and document are modified accordingly.",https://github.com/iovisor/bcc/commit/43e0c33d5c797a84c6b979c0ca3e9885a82842a5
iovisor/bcc,https://github.com/iovisor/bcc,db3234f,Wolfgang Frisch,2025-02-15T18:16:45Z,"bcc-lua: enable deterministic bytecode generation (#5213)  LuaJIT does not generate bytecode deterministically by default, which makes the build of bcc-lua unreproducible. However, support for deterministic bytecode was added to LuaJIT some time ago. This change enables it for bcc-lua.  - https://bugzilla.suse.com/show_bug.cgi?id=1236871 - https://github.com/LuaJIT/LuaJIT/issues/1008 - https://reproducible-builds.org/",https://github.com/iovisor/bcc/commit/db3234f07679cd8f7632576966a82874ff2a7d21
iovisor/bcc,https://github.com/iovisor/bcc,f954eb1,Feng Yang,2025-02-11T06:27:32Z,"libbpf-tools/softirqs: Fix logarithmic calculation issue (#5208)  Should use log2l.  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/f954eb1ec60a34ddc59535646be58085163e568f
iovisor/bcc,https://github.com/iovisor/bcc,cccb26e,Wei,2025-02-09T05:15:48Z,"examples/tracing/disksnoop.py: Fix kprobe attaching failure (#5209)  Fix issues/5124: ""Exception:Failed to attach BPF program ..."" by attaching the function blk_mq_end_request  blk_account_io_done became inline function since kernel v5.16 and blk_account_io_done has been taken off since v6.4. With this change, only when the code runs on a legacy kernel these *_io_done functions will be attached, otherwise it goes for blk_mq_end_request.  Co-authored-by: Wei <wei@hardenedlinux.org>",https://github.com/iovisor/bcc/commit/cccb26e3d69f0b263562c581add517ed23e1834b
iovisor/bcc,https://github.com/iovisor/bcc,f51ef84,Feng Yang,2025-02-09T04:37:49Z,"libbpf-tools/hardirqs: Fix logarithmic calculation issue (#5207)  Should use log2l  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/f51ef84e11780325e347a6535e8d0f37ce1f5465
iovisor/bcc,https://github.com/iovisor/bcc,cc20026,Rong Tao,2025-02-09T04:31:21Z,"libbpf-tools/opensnoop: Display mode for extended fields (#5206)  Do the same thing of [1] and add tracepoint/syscalls/sys_enter_openat2 support.  Link: https://github.com/iovisor/bcc/commit/e80ad4d859d4f6bf16709cb664c97f41e3136558 [1]  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/cc200260116f38d1470e341595386ba4b13e8d07
iovisor/bcc,https://github.com/iovisor/bcc,cdecaf1,Rong Tao,2025-02-09T04:17:44Z,"tools/opensnoop: Fix bad mode value (#5205)  O_TMPFILE = 020200000 = __O_TMPFILE | O_DIRECTORY  If flag contains only O_DIRECTORY, the mode value is invalid. The mode value is valid only when flag contains both __O_TMPFILE and O_DIRECTORY.  For example, 02204000 only contains __O_TMPFILE or O_DIRECTORY, will get bad random mode value:      $ sudo ./opensnoop.py -e     PID    COMM               FD ERR FLAGS    MODE PATH     1325   in:imjournal      108   0 02000101 146720225 /var/lib/rsyslog/imjournal.state.tmp                                       ^                                       __O_TMPFILE      927848 cgroupify           5   0 02204000 22343344131 .                                        ^                                        O_DIRECTORY  Fix: commit e80ad4d859d4 (""tools/opensnoop: Display mode for -e, --extended_fields (#5196)"")  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/cdecaf10fd33d0f2b9e7d71b72159919ace4e0b3
iovisor/bcc,https://github.com/iovisor/bcc,e80ad4d,Rong Tao,2025-02-01T00:02:08Z,"tools/opensnoop: Display mode for -e, --extended_fields (#5196)  When a program creates a file with mode=0000, it cannot even access the file itself. It would be helpful if we could track the mode value. so we can know who did it.  Example:      open(""a.txt"", O_WRONLY | O_EXCL | O_CREAT, 0000);  Then:      $ ls -l a.txt     ----------. 1 rongtao rongtao 0 Jan 24 09:07 a.txt     $ cat a.txt     cat: a.txt: Permission denied      $ sudo ./opensnoop.py -e     PID    COMM               FD ERR FLAGS    MODE PATH     673067 open                3   0 00000301 n/a  a.txt                                               ^^^^  If flags is an illegal value, displaying the mode value can better handle the relationship between flags and mode. After all, mode is only effective when flags only contains O_TMPFILE or O_CREAT.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/e80ad4d859d4f6bf16709cb664c97f41e3136558
iovisor/bcc,https://github.com/iovisor/bcc,0dc4282,Hengqi Chen,2025-01-27T05:55:16Z,"Drop support for LLVM 10 and below (#5202)  It has been 3 years since Dave propose to bump minimun LLVM version to 11. The CI is ready. So let's move on.  Closes #3808.  Signed-off-by: Hengqi Chen <hengqi.chen@gmail.com>",https://github.com/iovisor/bcc/commit/0dc42822d88e977d5fa58ad3f259b626e610b5c7
iovisor/bcc,https://github.com/iovisor/bcc,10ee9d9,jetlime,2025-01-22T21:33:20Z,INSTALL.md: Add build dependencies for Ubuntu 24.04 (#5199)  Add build dependencies for Ubuntu 24.04,https://github.com/iovisor/bcc/commit/10ee9d93c25113dff1393b074984553c72b05dc6
iovisor/bcc,https://github.com/iovisor/bcc,6878f24,kiraskyler,2025-01-22T21:32:23Z,"tools/cpuunclaimed: Remove unused python method imports (#5189)  Remove unused python method imports  Signed-off-by: niuwanli <niuwanli@cqsoftware.com.cn>",https://github.com/iovisor/bcc/commit/6878f2445328ba9dcedf708fa8f79bd088a3be65
iovisor/bcc,https://github.com/iovisor/bcc,c8515f7,yonghong-song,2025-01-19T02:30:12Z,"Update debian changelog for release v0.33.0 (#5195)  * Support for kernel up to 6.12   * Add new bcc tool numasched   * syms: Initialize ModulePath::fd_ to invalid FD   * libbpf-tools/memleak: Fix off-by-one error   * libbpf-tools/slabratetop: Fix failed to create kprobe error   * libbpf_tools/profile: Support PID namespace mapping   * libbpf-tools/mountsnoop: Support fsopen,fsconfig,fsmount,move_mount syscalls   * tools/oomkill: get application level stack trace   * tools/profile: Add additional information to backtrace   * tools/mountsnoop: Fix fsmount printing wrong flags   * tools/compactsnoop: Add aarch64 support   * doc update, other bug fixes and tools improvement.  Signed-off-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/c8515f7190896273a7a9d9e6e36ed339d89040e6
iovisor/bcc,https://github.com/iovisor/bcc,1832c03,yonghong-song,2025-01-19T01:11:21Z,"Fix llvm20 compilation error (#5194)  The following is the error message:  /home/yhs/work/bcc/src/cc/frontends/clang/b_frontend_action.cc: In member function      ‘bool ebpf::BTypeVisitor::VisitBinaryOperator(clang::BinaryOperator*)’: /home/yhs/work/bcc/src/cc/frontends/clang/b_frontend_action.cc:1383:64: error:      no matching function for call to ‘clang::FieldDecl::getBitWidthValue(clang::ASTContext&)’  1383 |             uint64_t sz = F->isBitField() ? F->getBitWidthValue(C) : C.getTypeSize(F->getType());       |                                             ~~~~~~~~~~~~~~~~~~~^~~  which is due to upstream patch:    https://github.com/llvm/llvm-project/pull/122289  This patch fixed the above compilation error.  Signed-off-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/1832c03ccf0ecbe90afb902db7c827faa6f2ca27
iovisor/bcc,https://github.com/iovisor/bcc,68710c4,Daniel Xu,2025-01-17T21:52:40Z,syms: Initialize ModulePath::fd_ to invalid FD  ~ModulePath() does `if (fd_ > 0) close fd_;`. But ModulePath constructor has early return codepath for `!enter_ns` which does not initialize `fd_`.  So `fd_` can potentially have junk value. That junk value could be any FD downstream. bcc cannot be closing random FDs.,https://github.com/iovisor/bcc/commit/68710c4f1f055cb05a5271917d6bad72ac3490d0
iovisor/bcc,https://github.com/iovisor/bcc,fea5b15,Feng Yang,2025-01-12T17:07:54Z,"tools/compactsnoop: Add aarch64 support (#5180)  Add aarch64 support.  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/fea5b15d745a5029055771dc370a7329e43627e0
iovisor/bcc,https://github.com/iovisor/bcc,9846a21,Rong Tao,2025-01-12T17:06:28Z,"README.md: Add tools/numasched contents (#5187)  bcc commit d188e07c46e1 (""tools: add numasched: trace task switch between NUMA (#4396)"") [1] add tools/numasched.py.  Link: https://github.com/iovisor/bcc/commit/d188e07c46e1e3da71b08f97c5d4f3cf69b16e09 [1]  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/9846a2190b19207c3ed9d1bfb2edeae4eb5c748e
iovisor/bcc,https://github.com/iovisor/bcc,d188e07,Rong Tao,2025-01-09T04:29:58Z,"tools: add numasched: trace task switch between NUMA (#4396)  Tasks frequently switch between NUMA, often resulting in poor performance.  programs running on the same NUMA will have better performance (usually at the memory level). If processes are migrating between different CPUs and these CPUs belong to different NUMAs, this tool provides an effective means of tracing to optimize the program or configuration.  For example:   Terminal 1:    $ numactl --hardware   available: 4 nodes (0-3)   node 0 cpus: 0 - 23   node 1 cpus: 24 - 47   node 2 cpus: 48 - 71   node 3 cpus: 72 - 95   Terminal 2:    $ sudo ./numasched.py   Tracing task NUMA switch...   TIME     PID      SRC_NID     DST_NID  COMM   Terminal 3:    $ taskset -c 1 yes >/dev/null &   $ taskset -p 0x1000000 $(pidof yes)   $ taskset -p 0x1000000000000 $(pidof yes)   Then, Terminal 2:    $ sudo ./numasched.py   Tracing task NUMA switch...   TIME     PID      TID      SRC_NID     DST_NID  COMM   20:55:35 355842   355842   0        -> 1        b'yes'   20:55:50 355842   355842   1        -> 2        b'yes'  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/d188e07c46e1e3da71b08f97c5d4f3cf69b16e09
iovisor/bcc,https://github.com/iovisor/bcc,ad05282,Rong Tao,2025-01-08T23:34:31Z,"tools/mountsnoop: Fix fsmount printing wrong flags (#5178)  fsmount(2) syscall 'flags' parameter only could be zero or FSMOUNT_CLOEXEC.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/ad052829fea174d7f152b28cd55385effdb44310
iovisor/bcc,https://github.com/iovisor/bcc,72965b6,ekyooo,2025-01-08T23:19:00Z,"tools/profile: Add additional information to backtrace (#5109)  Add additional information and change the format of the backtrace: - Include the symbol base offset and DSO name. - Symbol and DSO information is included if it's available in the target binary. - Format:   [SYMBOL+OFFSET] (MODULE) - Add a -A(or --addr) option for a detailed format that includes the address:   ADDR [SYMBOL+OFFSET] (MODULE)  before:   # ./profile.py       [unknown]       _PyDict_GetItem_KnownHash       [unknown]       [unknown]       [unknown]       [unknown]       _PyObject_MakeTpCall       _PyObject_CallFunction_SizeT       [unknown]       _PyEval_EvalFrameDefault       PyEval_EvalCode       [unknown]       [unknown]       _PyRun_SimpleFileObject       _PyRun_AnyFileObject       Py_RunMain       Py_BytesMain       __libc_start_call_main       __libc_start_main_impl       _start       -                python3 (384002)           1        [unknown]       [unknown]       [unknown]       [unknown]       [unknown]       [unknown]       -                gnome-shell (2302)           1  After:   # ./profile.py       runtime.typePointers.next+0x4b [grafana]       runtime.gcDrain+0x1f4 [grafana]       runtime.gcBgMarkWorker.func2+0xa5 [grafana]       runtime.systemstack.abi0+0x4a [grafana]       runtime.gcBgMarkWorker+0x1f2 [grafana]       runtime.goexit.abi0+0x1 [grafana]       -                grafana (25858)           1        runtime.nanotime1.abi0+0x89 [containerd]       runtime.sysmon+0x24b [containerd]       runtime.mstart1+0x95 [containerd]       runtime.mstart0+0x76 [containerd]       runtime.mstart.abi0+0x5 [containerd]       [unknown]       -                containerd (454924)           1        __get_user_8+0x10 [kernel]       __get_user_8+0x10 [kernel]       rseq_ip_fixup+0x69 [kernel]       __rseq_handle_notify_resume+0x2b [kernel]       syscall_exit_to_user_mode+0x1f9 [kernel]       do_syscall_64+0x8c [kernel]       entry_SYSCALL_64_after_hwframe+0x78 [kernel]       runtime.futex.abi0+0x23 [dockerd]       runtime.notesleep+0x87 [dockerd]       runtime.stopm+0x8c [dockerd]       runtime.findRunnable+0xd5f [dockerd]       runtime.schedule+0xb1 [dockerd]       runtime.park_m+0x1ec [dockerd]       runtime.mcall+0x50 [dockerd]       runtime.gopark+0xce [dockerd]       runtime.(*scavengerState).park+0x49 [dockerd]       runtime.bgscavenge+0x59 [dockerd]       runtime.gcenable.gowrap2+0x25 [dockerd]       runtime.goexit.abi0+0x1 [dockerd]       -                dockerd (144352)           1    # ./profile.py -A       0xffffffff945afbb8 __get_user_nocheck_4+0x8 [kernel]       0xffffffff945afbb8 __get_user_nocheck_4+0x8 [kernel]       0xffffffff936267be futex_wait_setup+0x7e [kernel]       0xffffffff9362697b __futex_wait+0x13b [kernel]       0xffffffff93626a94 futex_wait+0x74 [kernel]       0xffffffff93622765 do_futex+0x105 [kernel]       0xffffffff9362302a __x64_sys_futex+0x12a [kernel]       0xffffffff934071a7 x64_sys_call+0x1ce7 [kernel]       0xffffffff9462601f do_syscall_64+0x7f [kernel]       0xffffffff94800130 entry_SYSCALL_64_after_hwframe+0x78 [kernel]       0x00007df292898d61 __GI___futex_abstimed_wait_cancelable64+0xe1 [libc.so.6]       0x00007df29289bc7e pthread_cond_timedwait@@GLIBC_2.3.2+0x23e [libc.so.6]       0x0000645da1a160fa os_event::timed_wait(timespec const*)+0x3a [mysqld]       0x0000645da1a2f551 os_event::wait_time_low(std::chrono::duration<long, std::ratio<1l, 1000000l> >, long)+0x81 [mysqld]       0x0000645da19e44a9 log_files_governor(log_t*)+0x159 [mysqld]       0x0000645da19efb19 [unknown] [mysqld]       0x00007df292cecdb4 [unknown] [libstdc++.so.6.0.33]       0x00007df29289ca94 start_thread+0x384 [libc.so.6]       0x00007df292929c3c __GI___clone3+0x2c [libc.so.6]       -                ib_log_files_g (28830)           1",https://github.com/iovisor/bcc/commit/72965b6f3cf33d5da326ffd7d291cf7e0ccd9092
iovisor/bcc,https://github.com/iovisor/bcc,eabed37,Rong Tao,2024-12-20T02:24:16Z,"libbpf-tools/mountsnoop: Support fsopen,fsconfig,fsmount,move_mount syscalls  Do the same thing of bcc commit 60ebaf47347a (""tools/mountsnoop: Support fsopen(2), fsmount(2), fsconfig(2), move_mount(2)"")      $ sudo ./mountsnoop     COMM             PID     TID     MNT_NS      CALL     fsmount          431216  431216  4026531841  fsopen(""ext4"", 0x0) = 5     fsmount          431216  431216  4026531841  fsconfig(5, ""FSCONFIG_SET_FLAG"", ""rw"", """", 0) = 0     fsmount          431216  431216  4026531841  fsconfig(5, ""FSCONFIG_SET_STRING"", ""source"", ""/dev/loop0"", 0) = 0     fsmount          431216  431216  4026531841  fsconfig(5, ""FSCONFIG_CMD_CREATE"", """", """", 0) = 0     fsmount          431216  431216  4026531841  fsmount(5, ""0x0"", ""MOUNT_ATTR_RDONLY"") = 6     fsmount          431216  431216  4026531841  move_mount(6, """", AT_FDCWD, ""./tmp-dir/"", """") = 0     fsmount          431216  431216  4026531841  umount(""./tmp-dir/"", 0x0) = 0  In the above test, the C program is more complicated, so I will not show it here, but a test example is given in the link [1].  [1] https://github.com/torvalds/linux/blob/master/samples/vfs/test-fsmount.c  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/eabed37e3d7fbb73cd61a4fdf44db60fa596f95a
iovisor/bcc,https://github.com/iovisor/bcc,464f89b,Rong Tao,2024-12-20T02:02:26Z,"libbpf-tools/mountsnoop: Use union to pass arguments  Ready to introduce fsopen(2),fsconfig(2),fsmount(2),move_mount(2) syscall support.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/464f89b0d90b2d196ba7767ad706ad1af65500ed
iovisor/bcc,https://github.com/iovisor/bcc,ee36958,Anup Sharma,2025-01-08T22:10:24Z,"tools/klockstat: Remove Byte String Prefix in Output (#5179)  Byte strings are printed directly, leading to output with the 'b' prefix  example: Caller   Avg Spin  Count   Max spin Total spin b'ep_poll+0x16b'       1096  26576       8180   29145121 b'drm_fb_helper_damage_work+0x97'       1705     32       2870      54580 b'process_one_work+0x178'       1325     55       2520      72879 b'ext4_evict_inode+0x283'       1625     11       2400      17880  This fix decode the byte strings After fix:                                Caller   Avg Spin  Count   Max spin Total spin               process_one_work+0x178       1569     24       3530      37657                        ep_poll+0x16b       1037     12       3090      12450                         kthread+0xf2       2336      3       2830       7010               rcu_tasks_kthread+0xa4       1642      5       2490       8210  Signed-off-by: Anup Sharma <anupnewsmail@gmail.com>",https://github.com/iovisor/bcc/commit/ee36958dc766fb6f9e2f21537e988d4d16846d28
iovisor/bcc,https://github.com/iovisor/bcc,3845f7f,keosung,2024-12-18T16:48:43Z,"tools/ttysnoop: Fix a minor typo (#5175)  Fix typo from ""seperately"" to ""separately""  Signed-off-by: Keoseong Park <keosung.park@samsung.com>",https://github.com/iovisor/bcc/commit/3845f7f6e42bfe18a823938bfc140a90422e02f9
iovisor/bcc,https://github.com/iovisor/bcc,04dbccd,Eunseon Lee,2024-11-21T02:53:45Z,libbpf_tools/profile: Support PID namespace mapping if available in the kernel  Support PID namespace mapping only in kernels where bpf_get_ns_current_pid_tgid is available.,https://github.com/iovisor/bcc/commit/04dbccd520b2e748a6f769f9d74ff96d36a43104
iovisor/bcc,https://github.com/iovisor/bcc,ac05243,Eunseon Lee,2024-12-13T05:40:48Z,libbpf-tools/trace_helpers: Add helper to probe bpf_get_ns_current_pid_tgid  Add a utility function to check if bpf_get_ns_current_pid_tgid is available in the target kernel.,https://github.com/iovisor/bcc/commit/ac0524332c81ad35ec1fcf01fb9eaf722d5fe552
iovisor/bcc,https://github.com/iovisor/bcc,a9d426a,Eunseon Lee,2024-11-20T05:44:07Z,"libbpf-tools/profile: Add support for PID-namespacing  Add PID translation for nested PID namespace environments, such as container.",https://github.com/iovisor/bcc/commit/a9d426a0c683e56cdafbd1848e5c1a3c62f42bb1
iovisor/bcc,https://github.com/iovisor/bcc,244b8d5,Sai Aung Hlyan Htet,2024-12-18T04:24:24Z,"tools/oomkill: get application lvl stack trace (#5166)  Get an application level stack trace on oomkill  Signed-off-by: saiaunghlyanhtet <saiaunghlyanhtet2003@gmail.com>",https://github.com/iovisor/bcc/commit/244b8d5a175202f65ee4853722b2c3daa9aff7e0
iovisor/bcc,https://github.com/iovisor/bcc,948ac67,Feng Yang,2024-12-18T03:43:14Z,"libbpf-tools/slabratetop: Fix failed to create kprobe error (#5168)  Convert kmem_cache_alloc() to kmem_cache_alloc_noprof() in commit 7bd230a26648 So the higher version will have the following issues: libbpf: prog 'kmem_cache_alloc': failed to create kprobe 'kmem_cache_alloc+0x0' perf event: No such file or directory libbpf: prog 'kmem_cache_alloc': failed to auto-attach: -2 Failed to attach BPF programs: -2  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/948ac6710622e70085ddc5bb35b69ae86e51f0a7
iovisor/bcc,https://github.com/iovisor/bcc,32aaab7,Ning,2024-12-17T23:52:09Z,docs: fix a minor typo. (#5173)  Fix a minor typo.,https://github.com/iovisor/bcc/commit/32aaab7f6b6f722b73f8642b1500a3b73c01002e
iovisor/bcc,https://github.com/iovisor/bcc,2a5a8e3,Rong Tao,2024-12-17T23:51:28Z,"examples/networking: sockmap.py: Fix invalid bpf_context access off=24 size=8 (#5169)  clang generates such patterns occasionally when it thinks only up to specific size is accessed anyway. Fix the following error:      ; .remote_ip4 = skops->remote_ip4, @ main.c:29     7: (79) r2 = *(u64 *)(r1 +24)  Error detail:      $ sudo ./sockmap.py -c /path/to/cgroup/foo     bpf: Failed to load program: Permission denied     0: R1=ctx() R10=fp0     ; if (skops->family != AF_INET) @ main.c:55     0: (61) r2 = *(u32 *)(r1 +20)         ; R1=ctx() R2_w=scalar(smin=0,smax=umax=0xffffffff,var_off=(0x0; 0xffffffff))     1: (55) if r2 != 0x2 goto pc+88       ; R2_w=2     ; u32 op = skops->op; @ main.c:52     2: (61) r2 = *(u32 *)(r1 +0)          ; R1=ctx() R2_w=scalar(smin=0,smax=umax=0xffffffff,var_off=(0x0; 0xffffffff))     3: (18) r3 = 0xfffffffe               ; R3_w=0xfffffffe     ; switch (op) { @ main.c:58     5: (5f) r2 &= r3                      ; R2_w=scalar(smin=0,smax=umax=umax32=0xfffffffe,smax32=0x7ffffffe,var_off=(0x0; 0xfffffffe)) R3_w=0xfffffffe     6: (55) if r2 != 0x4 goto pc+83       ; R2_w=4     ; .remote_ip4 = skops->remote_ip4, @ main.c:29     7: (79) r2 = *(u64 *)(r1 +24)     invalid bpf_context access off=24 size=8     processed 7 insns (limit 1000000) max_states_per_insn 0 total_states 0 peak_states 0 mark_read 0      Traceback (most recent call last):       File ""/home/sda/git-repos/iovisor/bcc/examples/networking/./sockmap.py"", line 110, in <module>         func_sock_ops = bpf.load_func(""bpf_sockhash"", bpf.SOCK_OPS)       File ""/usr/lib/python3.13/site-packages/bcc/__init__.py"", line 526, in load_func         raise Exception(""Failed to load BPF program %s: %s"" %                         (func_name, errstr))     Exception: Failed to load BPF program b'bpf_sockhash': Permission denied  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/2a5a8e34859ed05a641cd700fd6b252753f11356
iovisor/bcc,https://github.com/iovisor/bcc,9e390e9,Bojun Seo,2024-12-01T16:54:04Z,"libbpf-tools/memleak: Fixes off-by-one error for `-Z` and `-z` option (#5149)  These are the description of each options written in memleak tool (libbpf-tools and tools directory):   -z option: capture only allocations larger than this size   -Z option: capture only allocations smaller than this size  But actually they work like this   -z option: capture only allocations larger than or equal to this size   -Z option: capture only allocations smaller than or equal to this size  Which means, there was off-by-one errors. So, fixes the explanation message.",https://github.com/iovisor/bcc/commit/9e390e97d5f28695d809120e8cfaeb7f2fb95a31
iovisor/bcc,https://github.com/iovisor/bcc,8d85dcf,yonghong-song,2024-11-24T05:38:46Z,"Update debian changelog for release v0.32.0 (#5157)  * Support for kernel up to 6.11.   * bcc tool update: wakeuptime, readahead, shmsnoop, offcputime, cachestat, cachetop, hardirqs   * libbpf tool update: futexctn, profile, readhead, softirqs, hardirqs   * Multiple enhancements for memleak: better error path checking, adding mremap uprobe, etc.   * Support get pid/tgid in pid namespaces (cpudist, profile)   * multiple pid filtering support: profile, offcputime   * detect whether elf binary is PIE even if the binary is marked as DYN   * Fix several compilation issues with llvm20   * doc update, other bug fixes and tools improvement.  Signed-off-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/8d85dcfac86bb7402a20bea5ceba373e5e019b6c
iovisor/bcc,https://github.com/iovisor/bcc,89c482a,yonghong-song,2024-11-24T04:31:11Z,"bpf: Sync with latest libbpf repo (#5156)  The sync'ed top libbpf commit:   c5f22aca0f3a  ci: remove llvm-17 variant of the workflow  Signed-off-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/89c482aa6c6a83dd8df01fe89d700fee506ae652
iovisor/bcc,https://github.com/iovisor/bcc,9713b91,yonghong-song,2024-11-23T21:47:25Z,"Fix LLVM-20 compilation failure (#5155)  Upstream llvm patch   https://github.com/llvm/llvm-project/pull/115852 changed signature for function createDiagnostics(). This patch fixed the issue.  Signed-off-by: Yonghong Song <yonghong.song@linux.dev>",https://github.com/iovisor/bcc/commit/9713b915441f9fa0d64b08273213dc7428d47760
iovisor/bcc,https://github.com/iovisor/bcc,ebcc7a7,Rong Tao,2024-11-23T18:44:28Z,"libbpf-tools: javagc: Hints for more information (#5154)  Prints a prompt message for not finding jvm.so and opening /proc/PID/maps incorrectly.  Signed-off-by: Rong Tao <rongtao@cestc.cn>",https://github.com/iovisor/bcc/commit/ebcc7a72be22dbf570104a86d94f6ffd755ee618
iovisor/bcc,https://github.com/iovisor/bcc,378d287,Xiaobo Liu,2024-11-23T17:39:23Z,"libbpf-tools/memleak: add mremap uprobe (#5151)  Add mremap uprobe.  Signed-off-by: Xiaobo Liu <cppcoffee@gmail.com>",https://github.com/iovisor/bcc/commit/378d2876b25b2e8c07816493d8f9583c7f86bb10
iovisor/bcc,https://github.com/iovisor/bcc,fb62cc3,Bojun Seo,2024-11-22T19:54:33Z,"tools/hardirqs: Print results in descending order (#5148)  Users are usually interested in events that happen frequently and consume more time. So, print the results in descending order.",https://github.com/iovisor/bcc/commit/fb62cc3f5e39ed5b3feda8d20858652042890de5
iovisor/bcc,https://github.com/iovisor/bcc,b384150,ekyooo,2024-11-18T17:40:08Z,"libbpf-tools/memleak: Fix to handle failure for invalid arguments (#5147)  Argument parsing errors are not detected for -p, -o, and -T due to the use of atoi. So, fixed these to handle invalid arguments by using strtol instead.  Before:   # ./memleak_new -p haha     using default object: libc.so.6     using page size: 4096     tracing kernel: false     Tracing outstanding memory allocs...  Hit Ctrl-C to end    # ./memleak -o 99999999999999999999999999999999999999999999999     using default object: libc.so.6     using page size: 4096     tracing kernel: true     Tracing outstanding memory allocs...  Hit Ctrl-C to end  After:   # ./memleak_new -p haha     error arg:p haha     Usage: memleak_new [OPTION...]     Try `memleak_new --help' or `memleak_new --usage' for more information.    # ./memleak_new -o 99999999999999999999999999999999999999999999999     error arg:o 99999999999999999999999999999999999999999999999     Usage: memleak_new [OPTION...]     Try `memleak_new --help' or `memleak_new --usage' for more information.    # ./memleak_new -o 9999999999999999     invalid AGE_MS: 9999999999999999     Usage: memleak_new [OPTION...]     Try `memleak_new --help' or `memleak_new --usage' for more information.",https://github.com/iovisor/bcc/commit/b384150b3afd0715e5e7cfd4b15e564b38b2d587
iovisor/bcc,https://github.com/iovisor/bcc,0985801,rockyxing,2024-11-18T17:28:03Z,"tools/cachestat,cachetop: Fix add_to_page_cache_lru/mark_page_accessed since kernel 5.16 (#5144)  For cachestat/cachetop tools, trace functions filemap_add_folio/folio_mark_accessed if available (>= 5.16 kernel).",https://github.com/iovisor/bcc/commit/098580115d43f230b19edcccf6883744b1ac3e2f
iovisor/bcc,https://github.com/iovisor/bcc,a47b7e4,Jeongik Cha,2024-11-18T17:08:49Z,"Add sys.stdout.flush() during print (#5142)  without that, pipe doesn't work well because of buffer",https://github.com/iovisor/bcc/commit/a47b7e40e4229215717ebe7dee40dde6fd7c6a26
iovisor/bcc,https://github.com/iovisor/bcc,629a5b4,Xiaobo Liu,2024-11-14T05:04:06Z,"libbpf-tools/memleak: mmap allocation failed, not added to pointer map (#5138)  If mmap allocation failed, the address will not be added to pointer map.  Signed-off-by: Xiaobo Liu <cppcoffee@gmail.com>",https://github.com/iovisor/bcc/commit/629a5b4feb5cd2841532524778c233d96a31287d
iovisor/bcc,https://github.com/iovisor/bcc,d53a9c1,Pradyumn Rahar,2024-11-14T04:37:27Z,"Add filters to filetop (#5003)  Add filters (--read-only and --write-only) to filetop.  Signed-off-by: Pradyumn Rahar <pradyumn.rahar@oracle.com>",https://github.com/iovisor/bcc/commit/d53a9c19056f5ec451961c685b323a21981bdcab
iovisor/bcc,https://github.com/iovisor/bcc,d9eec93,Hengqi Chen,2024-10-17T07:53:24Z,"libbpf-tools: Allow offcputime to run on kernels without BPF trampoline  Another compatibility game, allow offcputime to run on kernels without BPF trampoline using raw tracepoint.  Signed-off-by: Hengqi Chen <hengqi.chen@gmail.com>",https://github.com/iovisor/bcc/commit/d9eec93cfe46f1133aa8769f13b2550ca7edd08d
iovisor/bcc,https://github.com/iovisor/bcc,91de381,Hengqi Chen,2024-10-17T07:15:14Z,"libbpf-tools: Fix compilation error for gethostlatency  Fix the following compilation error with GCC 8.5.0:     gethostlatency.c: In function ‘attach_uprobes.isra.2’:     gethostlatency.c:157:58: error: ‘%s’ directive output may be truncated writing up to 4095 bytes into a region of size between 4074 and 4084 [-Werror=format-truncation=]          snprintf(proc_path, sizeof(proc_path), ""/proc/%d/root%s"", target_pid, buf);                                                               ^~               ~~~     gethostlatency.c:157:5: note: ‘snprintf’ output between 13 and 4118 bytes into a destination of size 4096          snprintf(proc_path, sizeof(proc_path), ""/proc/%d/root%s"", target_pid, buf);          ^~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~     cc1: all warnings being treated as errors  Signed-off-by: Hengqi Chen <hengqi.chen@gmail.com>",https://github.com/iovisor/bcc/commit/91de3813e9149495845e6670b9706268fbea6379
iovisor/bcc,https://github.com/iovisor/bcc,8446572,Bojun Seo,2024-11-07T10:50:29Z,"tools/softirqs: Print results in descending order  Users are usually interested in events that happen frequently and consume more time. So, print the results in descending order.",https://github.com/iovisor/bcc/commit/84465721fa0db9842f4aea0e0da55621320c2008
iovisor/bcc,https://github.com/iovisor/bcc,cb3ca18,Bojun Seo,2024-11-07T09:17:42Z,tools: Fixes explanation about -F option in biolatency_example.txt  -F option prints a separate histogram for each unique set of request flags. But the explanation right after the -F option example is not about this option.,https://github.com/iovisor/bcc/commit/cb3ca18828f6af8ec16de57438683889d40aefb2
iovisor/bcc,https://github.com/iovisor/bcc,2b82d76,Bojun Seo,2024-11-07T09:35:09Z,tools/threadsnoop: Add -h option  Import argparser and add basic implementation for this. Now user can use -h option for threadsnoop tool.,https://github.com/iovisor/bcc/commit/2b82d76bbde9764e5f914b523a5ed8285e18870d
iovisor/bcc,https://github.com/iovisor/bcc,791b96e,Bojun Seo,2024-11-07T09:08:57Z,tools: Fixes typo in biolatency_example.txt file,https://github.com/iovisor/bcc/commit/791b96ec2f1df18817306924d7fc5f59347e7871
iovisor/bcc,https://github.com/iovisor/bcc,1838523,Bojun Seo,2024-11-07T08:18:44Z,tools: Add # at the beginning of example command  \# at the beginning can show that it is a command Add # at the beginning of the example command in biolatenxy_example.txt,https://github.com/iovisor/bcc/commit/1838523669681114b1277c547a0a0d25a40fc477
iovisor/bcc,https://github.com/iovisor/bcc,0b5be9b,Rong Tao,2024-10-27T09:02:30Z,"elf: Detect if Elf is PIE  It is not sufficient to determine whether Elf is ET_DYN or not to be a dynamic library in bcc_elf_is_shared_obj() function, because the executable Elf of the PIE type is also ET_DYN.  For example, on Fedora 41, /usr/bin/bash is PIE:      $ readelf -h /usr/bin/bash     ELF Header:       ...       Type:                     DYN (Position-Independent Executable file)       ...  bcc_elf_is_shared_obj() should not return 'true' for /usr/bin/bash.  This commit add function bcc_elf_is_pie() and export it in bcc_elf.h.  At the same time, fix test py_test_usdt3.  Signed-off-by: Rong Tao <rongtao@cestc.cn> Signed-off-by: Jiang Guirong <2386499836@qq.com>",https://github.com/iovisor/bcc/commit/0b5be9bbfc9b58b679dde96b3ea25079a7b290e5
iovisor/bcc,https://github.com/iovisor/bcc,d36ab45,Feng Yang,2024-10-21T07:25:33Z,Add support for zfs to fsdist and fsslower tools  Add zfs based on zfsdist.py and zfsslower.py.  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>,https://github.com/iovisor/bcc/commit/d36ab45145cd60205b4b44504090d62f716f7a0d
iovisor/bcc,https://github.com/iovisor/bcc,0d5dcf4,Feng Yang,2024-10-13T15:56:01Z,"tools/tcpcong: Reduce code redundancy  1: Ports that do not meet the conditions in function ""entry_state_update_func"" will not be stored in the ""start_ipv4"" or ""start_ipv6"", and the ""ret_state_update_func"" function will not obtain values, so there is no need to perform port filtering again.  2: Sock_store can be directly deleted in function ""ret_func"".  Signed-off-by: Feng Yang <yangfeng@kylinos.cn>",https://github.com/iovisor/bcc/commit/0d5dcf40bc0dd8afe5885e36241f1956cc7dabe3
iovisor/bcc,https://github.com/iovisor/bcc,321f8b1,Dantezy,2024-09-14T08:30:19Z,libbpf-tools/hardirqs: add `--cpu/-s` for hardirqs  Signed-off-by: Dantezy <zhangyet@gmail.com>,https://github.com/iovisor/bcc/commit/321f8b113a397bac9ba17bf05c087a2fa350ed2a
iovisor/bcc,https://github.com/iovisor/bcc,799acc7,Dantezy,2024-09-13T12:28:35Z,"libbpf-tools/softirqs: Add `-c/--cpu` option to filter cpu  tools/softirqs.py supports `-c/--cpu` otption to filter cpu, It's reasonable to support a same otption for libbpf-tools/softirqs.  Add `-mcpu=v3` in Makefile for softirqs or the shift op will lead to verifier errors.  Reported-by: Tang Yizhou <tangyeechou@gmail.com> Signed-off-by: Dantezy <zhangyet@gmail.com>",https://github.com/iovisor/bcc/commit/799acc7ca2c618d9b467f79e63ba9a0059a22121
iovisor/bcc,https://github.com/iovisor/bcc,4138cc4,Bojun Seo,2024-10-08T01:53:06Z,libbpf-tools/profile: Remove unnecessary parameter  Parameter freq of open_and_attach_perf_event is not in use. So remove it.,https://github.com/iovisor/bcc/commit/4138cc42c563f11e7f476056b22457f942ff565d
iovisor/bcc,https://github.com/iovisor/bcc,86d006a,Eunseon Lee,2024-09-26T11:08:16Z,"libbpf-tools/trace_helpers: Add a utility to split and convert string  Add a utility API to split and convert strings for argument parsing.  Also, apply the API usage to offcputime and profile to remove duplicates.",https://github.com/iovisor/bcc/commit/86d006a6c8c0334d9d4e06c81e45f151c0237bad
iovisor/bcc,https://github.com/iovisor/bcc,280d822,Eunseon Lee,2024-09-16T13:48:12Z,"libbpf-tools/offcputime: Add multi process/thread support  This is a test example.    # ./offcputime -p 16,48     Tracing off-CPU time (us) of PID [16, 48]... Hit Ctrl-C to end.         bpf_prog_a42aae11c0bc18f2_sched_switch         bpf_prog_a42aae11c0bc18f2_sched_switch         bpf_trace_run4         __traceiter_sched_switch         __schedule         schedule         worker_thread         kthread         ret_from_fork         ret_from_fork_asm         -                kworker/2:1 (48)             3353019          bpf_prog_a42aae11c0bc18f2_sched_switch         bpf_prog_a42aae11c0bc18f2_sched_switch         bpf_trace_run4         __traceiter_sched_switch         __schedule         schedule         rcu_gp_kthread         kthread         ret_from_fork         ret_from_fork_asm         -                rcu_preempt (16)             1720974",https://github.com/iovisor/bcc/commit/280d822ab3bbc0670cefaac97c8b5000eb8307a5
iovisor/bcc,https://github.com/iovisor/bcc,cb1ba20,Eunseon Lee,2024-09-26T11:19:18Z,libbpf-tools/profile: Fix the help message for multi process/thread  Modify the help message for multi-process/thread support in libbpf-tools/profile and tools/profile.,https://github.com/iovisor/bcc/commit/cb1ba20f4800f556dc940682ba7016c50bd0a3ac
iovisor/bcc,https://github.com/iovisor/bcc,c4bf8bf,Holger Hoffstätte,2024-09-28T03:06:19Z,"Remove unneeded error.h include to allow build with musl libc (#5105)  musl libc has no error.h, but luckily the include is not needed at all and can just be removed.",https://github.com/iovisor/bcc/commit/c4bf8bfe2058255d7b933ceee184c27915719b52
iovisor/bcc,https://github.com/iovisor/bcc,9f3d0df,Premium,2024-09-08T23:55:46Z,Pid namespace support (#5101)  cpudist.py supports run in pid namespace,https://github.com/iovisor/bcc/commit/9f3d0df263b884e1fcaf39c529e3611b90462dba
iovisor/bcc,https://github.com/iovisor/bcc,6acb86e,Yonghong Song,2024-09-04T01:25:51Z,Set cpu=v1 explicitly  Upstream patch   https://github.com/llvm/llvm-project/pull/107008 makes cpu=v3 as the default. Previously cpu=v1 as the default for bcc. Let us mark cpu=v1 explicitly for bcc for now to keep it backword compatible.,https://github.com/iovisor/bcc/commit/6acb86effa7a6e8029b68eccb805dd1ee60ecc5a
iovisor/bcc,https://github.com/iovisor/bcc,d472825,Yonghong Song,2024-09-04T00:57:00Z,Fix a compilation issue with llvm20  The upstream commit   https://github.com/llvm/llvm-project/pull/82240 introduced a func signature change for func getFileLineInfoForAddress(). Add proper change to accommodate llvm20 need for additional func arguments.,https://github.com/iovisor/bcc/commit/d472825402a7cac4749c95cf1089722c0e2474bc
iovisor/bcc,https://github.com/iovisor/bcc,ebdd760,Yingming Mao,2024-08-29T17:25:28Z,"offcputime: Support tracking specified processes and threads  Inspired by the perf-top command, the offcputime tool is enhanced to support tracking multiple processes and threads.  $ man perf-top        -p <pid>, --pid=<pid>            Profile events on existing Process ID (comma separated list).        -t <tid>, --tid=<tid>            Profile events on existing thread ID (comma separated list). Before: $ offcputime  -h optional arguments:   -p PID, --pid PID     trace this PID only   -t TID, --tid TID     trace this TID only examples:     ./offcputime -p 185      # only trace threads for PID 185     ./offcputime -t 188      # only trace thread 188  After: $ offcputime -h optional arguments:   -p PID, --pid PID     trace these PIDs only, comma separated list   -t TID, --tid TID     trace these TIDs only, comma separated list examples:     ./offcputime -p 185,175,165 # only trace threads for PID 185,175,165     ./offcputime -t 188,120,134 # only trace threads 188,120,134  Signed-off-by: Yingming Mao <maoyingming@baidu.com> Reviewed-by: Shuo Li <lishuo02@baidu.com>",https://github.com/iovisor/bcc/commit/ebdd760b71fa8cd9c50bec17a5020c9c4118ebd6
iovisor/bcc,https://github.com/iovisor/bcc,0b2b116,Shawn Zhong,2024-09-03T22:11:52Z,"libpf-tools/readahead: Fix attachment failure since v5.16 (#5086)  This PR accounts for the rename/refactor of the following functions      __do_page_cache_readahead -> do_page_cache_ra -> page_cache_ra_order by torvalds/linux@8238287eadb2 and torvalds/linux@56a4d67c264e     __page_cache_alloc -> filemap_alloc_folio -> filemap_alloc_folio_noprof by torvalds/linux@bb3c579e25e5 and torvalds/linux@b951aaff5035.",https://github.com/iovisor/bcc/commit/0b2b116f894ab7ce77ddcef7a8bcbd2ff4238fcd
